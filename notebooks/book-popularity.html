
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>What makes a good book? &#8212; datuz</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-232XT3FYCT"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-232XT3FYCT');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-232XT3FYCT');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/book-popularity';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="icon" href="../_static/logo.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Analyzing global internet patterns" href="internet-patterns.html" />
    <link rel="prev" title="Predicting Industrial Machine Downtime" href="machine-downtime.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.svg" class="logo__image only-light" alt="datuz - Home"/>
    <img src="../_static/logo.svg" class="logo__image only-dark pst-js-only" alt="datuz - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Data Science projects
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../projects_competition.html">Competition projects</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="machine-downtime.html">Predicting Industrial Machine Downtime</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">What makes a good book?</a></li>
<li class="toctree-l2"><a class="reference internal" href="internet-patterns.html">Analyzing global internet patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleepinc.html">Helping find a better sleep</a></li>
<li class="toctree-l2"><a class="reference internal" href="hairloss.html">Hairloss Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="employee-network.html">Employee Network Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="hospital.html">Reducing hospital readmissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="hotels.html">Predicting hotel cancellations</a></li>
<li class="toctree-l2"><a class="reference internal" href="webpage.html">Was a website redesign successful?</a></li>
<li class="toctree-l2"><a class="reference internal" href="segmentation.html">Improving customer segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="abalone.html">Seafood farm process improvement</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../projects_personal.html">Personal projects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="land_cover.html">Land Cover Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="chm.html">Canopy Height Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="moles.html">Mole monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="book-translation.html">Book translation</a></li>
<li class="toctree-l2"><a class="reference internal" href="p-antio-gpt.html">Sentiment analysis with embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="self-tracking.html">Self tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="quakes.html">Earth Quakes</a></li>
<li class="toctree-l2"><a class="reference internal" href="climate.html">Climate Change</a></li>
<li class="toctree-l2"><a class="reference internal" href="english-vocab.html">English Vocab</a></li>
<li class="toctree-l2"><a class="reference internal" href="antio.html">Bar Reviews</a></li>
<li class="toctree-l2"><a class="reference internal" href="ignatian.html">Ignatian Pilgrims</a></li>
<li class="toctree-l2"><a class="reference internal" href="p-udalmap.html">Municipal Indicators</a></li>
<li class="toctree-l2"><a class="reference internal" href="p-films.html">Movie records</a></li>
<li class="toctree-l2"><a class="reference internal" href="ages.html">Median Ages</a></li>
<li class="toctree-l2"><a class="reference internal" href="water.html">Water Supplies</a></li>
<li class="toctree-l2"><a class="reference internal" href="olele.html">Handfan Reviews</a></li>
<li class="toctree-l2"><a class="reference internal" href="traffic_fines.html">Traffic Fines</a></li>
<li class="toctree-l2"><a class="reference internal" href="urban_trees.html">Urban Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="breads.html">Bread Prices</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../writings.html">Writings</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../writings/la-importancia-de-adquirir-competencias-en-materia-de-datos.html">La importancia de adquirir competencias en materia de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/la-ciencia-de-convertir-los-datos-en-valor.html">La ciencia de convertir los datos en valor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/que-es-la-inteligencia-artificial.html">¿Qué es la Inteligencia Artificial?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/aprendizaje-autom%C3%A1tico-vs-programaci%C3%B3n-tradicional.html">Aprendizaje automático vs programación tradicional</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/que-es-la-inteligencia-artificial-generativa.html">¿Qué es la Inteligencia Artificial Generativa?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/la-definicion-de-atributos-en-aprendizaje-automatico.html">La definición de atributos en aprendizaje automático</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/por-que-python.html">¿Por qué Python?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/estadistica-computacional-la-estadistica-sin-dolor.html">Estadística computacional: la estadística sin dolor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/como-funciona-el-aprendizaje-profundo.html">¿Cómo funciona el aprendizaje profundo?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/ia-predictiva-vs-ia-generativa.html">IA predictiva vs IA generativa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/etica-en-la-ia.html">Ética en la IA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/las-3-capas-de-un-proyecto-de-datos.html">Las 3 capas de un proyecto de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/ia-aplicada-la-empresa-empoderada-por-la-ia.html">IA aplicada: la empresa empoderada por la IA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/llm-modo-de-empleo.html">LLM: modo de empleo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../writings/ley-de-ia-de-la-ue.html">Ley de IA de la UE</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/mikel-imaz/projects" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/book-popularity.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>What makes a good book?</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-project">The project</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data">The data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-validation">Data validation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-the-data">Read the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-data-quality">Check data quality</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-values">Missing values</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#duplicated-values">Duplicated values</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-value-ranges">Check value ranges</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-data">Categorical data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-data">Numerical data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preprocessing">Data preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#split-review-helpfulness">Split “review/helpfulness”</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sentiment-analysis-in-review-texts">Sentiment analysis in review texts</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#word-tokenize-review-texts">Word tokenize review texts</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#split-authors-names">Split authors’ names</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lowercase-categories">Lowercase categories</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-data-types">Convert data types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classifier">Classifier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-hot-encoding">1) One-hot encoding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-together-rare-categories">2) Grouping together rare categories</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#target-encoding">3) Target encoding</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="what-makes-a-good-book">
<h1>What makes a good book?<a class="headerlink" href="#what-makes-a-good-book" title="Link to this heading">#</a></h1>
<p><img alt="" src="../_images/books_pattern.jpg" /></p>
<p><em>A <a class="reference external" href="https://datacamp.com">DataCamp</a> challenge</em>     <svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-calendar" viewBox="0 0 16 16" aria-hidden="true"><path d="M4.75 0a.75.75 0 0 1 .75.75V2h5V.75a.75.75 0 0 1 1.5 0V2h1.25c.966 0 1.75.784 1.75 1.75v10.5A1.75 1.75 0 0 1 13.25 16H2.75A1.75 1.75 0 0 1 1 14.25V3.75C1 2.784 1.784 2 2.75 2H4V.75A.75.75 0 0 1 4.75 0ZM2.5 7.5v6.75c0 .138.112.25.25.25h10.5a.25.25 0 0 0 .25-.25V7.5Zm10.75-4H2.75a.25.25 0 0 0-.25.25V6h11V3.75a.25.25 0 0 0-.25-.25Z"></path></svg> Feb, 2025</p>
<p><span class="sd-sphinx-override sd-badge sd-outline-secondary sd-text-secondary">Classification</span></p>
<section id="the-project">
<h2>The project<a class="headerlink" href="#the-project" title="Link to this heading">#</a></h2>
<p>Build a model that accurately predicts book popularity, which will help a bookstore manage their stock better and tweak their marketing plans to suit what their readers love the most.</p>
</section>
<section id="the-data">
<h2>The data<a class="headerlink" href="#the-data" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'title'</span></code></p></td>
<td><p>Book title.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'price'</span></code></p></td>
<td><p>Book price.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'review/helpfulness'</span></code></p></td>
<td><p>The number of helpful reviews over the total number of reviews.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'review/summary'</span></code></p></td>
<td><p>The summary of the review.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'review/text'</span></code></p></td>
<td><p>The review’s full text.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'description'</span></code></p></td>
<td><p>The book’s description.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'authors'</span></code></p></td>
<td><p>Author.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'categories'</span></code></p></td>
<td><p>Book categories.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'popularity'</span></code></p></td>
<td><p>Whether the book was popular or unpopular.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="data-validation">
<h2>Data validation<a class="headerlink" href="#data-validation" title="Link to this heading">#</a></h2>
<section id="read-the-data">
<h3>Read the data<a class="headerlink" href="#read-the-data" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import packages</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">nltk</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">category_encoders</span><span class="w"> </span><span class="kn">import</span> <span class="n">TargetEncoder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nltk</span><span class="w"> </span><span class="kn">import</span> <span class="n">word_tokenize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nltk.sentiment.vader</span><span class="w"> </span><span class="kn">import</span> <span class="n">SentimentIntensityAnalyzer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="c1"># Read the data</span>
<span class="n">books</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/books.csv&quot;</span><span class="p">)</span>
<span class="n">books</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>price</th>
      <th>review/helpfulness</th>
      <th>review/summary</th>
      <th>review/text</th>
      <th>description</th>
      <th>authors</th>
      <th>categories</th>
      <th>popularity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>We Band of Angels: The Untold Story of America...</td>
      <td>10.88</td>
      <td>2/3</td>
      <td>A Great Book about women in WWII</td>
      <td>I have alway been a fan of fiction books set i...</td>
      <td>In the fall of 1941, the Philippines was a gar...</td>
      <td>'Elizabeth Norman'</td>
      <td>'History'</td>
      <td>Unpopular</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Prayer That Brings Revival: Interceding for Go...</td>
      <td>9.35</td>
      <td>0/0</td>
      <td>Very helpful book for church prayer groups and...</td>
      <td>Very helpful book to give you a better prayer ...</td>
      <td>In Prayer That Brings Revival, best-selling au...</td>
      <td>'Yong-gi Cho'</td>
      <td>'Religion'</td>
      <td>Unpopular</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The Mystical Journey from Jesus to Christ</td>
      <td>24.95</td>
      <td>17/19</td>
      <td>Universal Spiritual Awakening Guide With Some ...</td>
      <td>The message of this book is to find yourself a...</td>
      <td>THE MYSTICAL JOURNEY FROM JESUS TO CHRIST Disc...</td>
      <td>'Muata Ashby'</td>
      <td>'Body, Mind &amp; Spirit'</td>
      <td>Unpopular</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Death Row</td>
      <td>7.99</td>
      <td>0/1</td>
      <td>Ben Kincaid tries to stop an execution.</td>
      <td>The hero of William Bernhardt's Ben Kincaid no...</td>
      <td>Upon receiving his execution date, one of the ...</td>
      <td>'Lynden Harris'</td>
      <td>'Social Science'</td>
      <td>Unpopular</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sound and Form in Modern Poetry: Second Editio...</td>
      <td>32.50</td>
      <td>18/20</td>
      <td>good introduction to modern prosody</td>
      <td>There's a lot in this book which the reader wi...</td>
      <td>An updated and expanded version of a classic a...</td>
      <td>'Harvey Seymour Gross', 'Robert McDowell'</td>
      <td>'Poetry'</td>
      <td>Unpopular</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>15714</th>
      <td>Attack of the Deranged Mutant Killer Monster S...</td>
      <td>7.64</td>
      <td>0/0</td>
      <td>Great for Calvin lovers</td>
      <td>Bought as a Christmas gift, great book for kin...</td>
      <td>Online: gocomics.com/calvinandhobbes/</td>
      <td>'Bill Watterson'</td>
      <td>'Comics &amp; Graphic Novels'</td>
      <td>Unpopular</td>
    </tr>
    <tr>
      <th>15715</th>
      <td>Book Savvy</td>
      <td>33.99</td>
      <td>2/2</td>
      <td>literary pleasure</td>
      <td>I thoroughly enjoyed Ms. Katona's Book Savvy. ...</td>
      <td>Recounts the adventures of Mibs Beaumont, whos...</td>
      <td>'Ingrid Law'</td>
      <td>'Juvenile Fiction'</td>
      <td>Popular</td>
    </tr>
    <tr>
      <th>15716</th>
      <td>Organizing to Win: New Research on Union Strat...</td>
      <td>24.95</td>
      <td>3/4</td>
      <td>Great Book for Union Organizers!</td>
      <td>This is a good reference tool for Union Organi...</td>
      <td>As the American labour movement mobilizes for ...</td>
      <td>'Kate Bronfenbrenner', 'Sheldon Friedman', 'Ri...</td>
      <td>'Business &amp; Economics'</td>
      <td>Popular</td>
    </tr>
    <tr>
      <th>15717</th>
      <td>The Dharma Bums</td>
      <td>39.95</td>
      <td>3/3</td>
      <td>The Sad, Beautiful, Joyful World of Jack Kerouac</td>
      <td>Jack Kerouac was intensely alive and his fiery...</td>
      <td>THE DHARMA BUMS appeared just one year after t...</td>
      <td>'Jack Kerouac'</td>
      <td>'Fiction'</td>
      <td>Popular</td>
    </tr>
    <tr>
      <th>15718</th>
      <td>Palomino</td>
      <td>7.99</td>
      <td>0/0</td>
      <td>"Palomino"</td>
      <td>This is an older novel of Danielle Steele's, a...</td>
      <td>Samantha Taylor is shattered when her husband ...</td>
      <td>'Danielle Steel'</td>
      <td>'Fiction'</td>
      <td>Popular</td>
    </tr>
  </tbody>
</table>
<p>15719 rows × 9 columns</p>
</div></div></div>
</div>
</section>
<section id="check-data-quality">
<h3>Check data quality<a class="headerlink" href="#check-data-quality" title="Link to this heading">#</a></h3>
<section id="missing-values">
<h4>Missing values<a class="headerlink" href="#missing-values" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get df info</span>
<span class="n">books</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 15719 entries, 0 to 15718
Data columns (total 9 columns):
 #   Column              Non-Null Count  Dtype  
---  ------              --------------  -----  
 0   title               15719 non-null  object 
 1   price               15719 non-null  float64
 2   review/helpfulness  15719 non-null  object 
 3   review/summary      15718 non-null  object 
 4   review/text         15719 non-null  object 
 5   description         15719 non-null  object 
 6   authors             15719 non-null  object 
 7   categories          15719 non-null  object 
 8   popularity          15719 non-null  object 
dtypes: float64(1), object(8)
memory usage: 1.1+ MB
</pre></div>
</div>
</div>
</div>
<p>There is only one missing values, I will drop that row.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop missing values</span>
<span class="n">books</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="duplicated-values">
<h4>Duplicated values<a class="headerlink" href="#duplicated-values" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check on all columns</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Duplicated rows -&gt; </span><span class="si">{</span><span class="n">books</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Duplicated rows -&gt; 3294
</pre></div>
</div>
</div>
</div>
<p>I will drop all duplicated records.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop duplicated rows</span>
<span class="n">books</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="check-value-ranges">
<h3>Check value ranges<a class="headerlink" href="#check-value-ranges" title="Link to this heading">#</a></h3>
<section id="categorical-data">
<h4>Categorical data<a class="headerlink" href="#categorical-data" title="Link to this heading">#</a></h4>
<p>Let’s see value ranges in categorical data columns <code class="docutils literal notranslate"><span class="pre">authors</span></code> and <code class="docutils literal notranslate"><span class="pre">categories</span></code>, and the balance of the target variable <code class="docutils literal notranslate"><span class="pre">popularity</span></code>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print number of unique values</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of unique &#39;authors&#39; -&gt; </span><span class="si">{</span><span class="n">books</span><span class="p">[</span><span class="s2">&quot;authors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of unique &#39;categories&#39; -&gt; </span><span class="si">{</span><span class="n">books</span><span class="p">[</span><span class="s2">&quot;categories&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of unique &#39;authors&#39; -&gt; 6447
Number of unique &#39;categories&#39; -&gt; 313
</pre></div>
</div>
</div>
</div>
<p>We can see that these categorical columns, especially “authors”, have lots of unique values (“high cardinality”).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the counting of top authors</span>
<span class="n">n_top</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">books</span><span class="p">[</span><span class="s2">&quot;authors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[:</span><span class="n">n_top</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Top </span><span class="si">{</span><span class="n">n_top</span><span class="si">}</span><span class="s2"> authors&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Counts&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/499a8d3fb8477942dd0dd1a198102e3fde23335e8a89d2f26ea1c418b3215bf6.png" src="../_images/499a8d3fb8477942dd0dd1a198102e3fde23335e8a89d2f26ea1c418b3215bf6.png" />
</div>
</div>
<p>We also observe that some authors consist of more than one name, separated by a comma, as seen in the case of ‘Charlotte Brontë, Marc Cactus’ in the 4th position, and also ‘Charlotte Brontë’ in the 5th position.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the counting of top authors</span>
<span class="n">n_top</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">books</span><span class="p">[</span><span class="s2">&quot;categories&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[:</span><span class="n">n_top</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Top </span><span class="si">{</span><span class="n">n_top</span><span class="si">}</span><span class="s2"> categories&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Counts&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/5304a4b57aee7c5637d98fca2e8d8eee3e51e960e02ef8a4dfd3fbf1c240b466.png" src="../_images/5304a4b57aee7c5637d98fca2e8d8eee3e51e960e02ef8a4dfd3fbf1c240b466.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot popularity counts</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">books</span><span class="p">[</span><span class="s2">&quot;popularity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Counts&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/9765bf3e13cc90fbb63ad344a0090f83235fa43040b3990c330343f5a613d51b.png" src="../_images/9765bf3e13cc90fbb63ad344a0090f83235fa43040b3990c330343f5a613d51b.png" />
</div>
</div>
</section>
<section id="numerical-data">
<h4>Numerical data<a class="headerlink" href="#numerical-data" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot prices&#39; histogram</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">books</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;hist&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Price&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/6a85501d97d198b5bf96a1b8d1b6ca8ca80e70f0d2df6ed22e1856f43c1b4273.png" src="../_images/6a85501d97d198b5bf96a1b8d1b6ca8ca80e70f0d2df6ed22e1856f43c1b4273.png" />
</div>
</div>
</section>
</section>
<section id="data-preprocessing">
<h3>Data preprocessing<a class="headerlink" href="#data-preprocessing" title="Link to this heading">#</a></h3>
<section id="split-review-helpfulness">
<h4>Split “review/helpfulness”<a class="headerlink" href="#split-review-helpfulness" title="Link to this heading">#</a></h4>
<p>“review/helpfulness” column can be split into two different columns: “helpful_reviews” and “total_reviews”.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split strings around &quot;/&quot; separator, and convert new columns to numerical integer</span>
<span class="n">books</span><span class="p">[[</span><span class="s2">&quot;helpful_reviews&quot;</span><span class="p">,</span> <span class="s2">&quot;total_reviews&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">books</span><span class="p">[</span><span class="s2">&quot;review/helpfulness&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Show result in first rows</span>
<span class="n">books</span><span class="p">[[</span><span class="s2">&quot;review/helpfulness&quot;</span><span class="p">,</span> <span class="s2">&quot;helpful_reviews&quot;</span><span class="p">,</span> <span class="s2">&quot;total_reviews&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>review/helpfulness</th>
      <th>helpful_reviews</th>
      <th>total_reviews</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2/3</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0/0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17/19</td>
      <td>17</td>
      <td>19</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0/1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18/20</td>
      <td>18</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop processed column</span>
<span class="n">books</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;review/helpfulness&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="sentiment-analysis-in-review-texts">
<h4>Sentiment analysis in review texts<a class="headerlink" href="#sentiment-analysis-in-review-texts" title="Link to this heading">#</a></h4>
<p>I will apply sentiment analysis to get a polarity score (between [-1, 1], with “-1” negative, “0” neutral, “1” positive) in “review/summary” and “review/text” columns.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download the VADER lexicon</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;vader_lexicon&quot;</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Instanciate sentiment analyzer</span>
<span class="n">sentiment_analyzer</span> <span class="o">=</span> <span class="n">SentimentIntensityAnalyzer</span><span class="p">()</span>

<span class="c1"># Apply to review summary and text columns creating new features</span>
<span class="n">books</span><span class="p">[</span><span class="s2">&quot;review_sum_sent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s2">&quot;review/summary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">text</span><span class="p">:</span> <span class="n">sentiment_analyzer</span><span class="o">.</span><span class="n">polarity_scores</span><span class="p">(</span><span class="n">text</span><span class="p">)[</span><span class="s2">&quot;compound&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">books</span><span class="p">[</span><span class="s2">&quot;review_text_sent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s2">&quot;review/text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">text</span><span class="p">:</span> <span class="n">sentiment_analyzer</span><span class="o">.</span><span class="n">polarity_scores</span><span class="p">(</span><span class="n">text</span><span class="p">)[</span><span class="s2">&quot;compound&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Show result in first rows</span>
<span class="n">books</span><span class="p">[[</span><span class="s2">&quot;review/summary&quot;</span><span class="p">,</span> <span class="s2">&quot;review_sum_sent&quot;</span><span class="p">,</span> <span class="s2">&quot;review/text&quot;</span><span class="p">,</span> <span class="s2">&quot;review_text_sent&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>review/summary</th>
      <th>review_sum_sent</th>
      <th>review/text</th>
      <th>review_text_sent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A Great Book about women in WWII</td>
      <td>0.6249</td>
      <td>I have alway been a fan of fiction books set i...</td>
      <td>0.8482</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Very helpful book for church prayer groups and...</td>
      <td>0.4754</td>
      <td>Very helpful book to give you a better prayer ...</td>
      <td>0.8955</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Universal Spiritual Awakening Guide With Some ...</td>
      <td>0.0000</td>
      <td>The message of this book is to find yourself a...</td>
      <td>0.9155</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ben Kincaid tries to stop an execution.</td>
      <td>-0.2960</td>
      <td>The hero of William Bernhardt's Ben Kincaid no...</td>
      <td>-0.2582</td>
    </tr>
    <tr>
      <th>4</th>
      <td>good introduction to modern prosody</td>
      <td>0.4404</td>
      <td>There's a lot in this book which the reader wi...</td>
      <td>0.9571</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Is there a positive correlation between the review text score and the summary sentiment score?</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check correlation</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s2">&quot;review_sum_sent&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">books</span><span class="p">[</span><span class="s2">&quot;review_text_sent&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">corr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> &lt;- correlation between sentiment in review summary and text&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.26 &lt;- correlation between sentiment in review summary and text
</pre></div>
</div>
</div>
</div>
<p>Scarce correlation. So I will leave it like that, without merging them in an average value.</p>
</section>
<section id="word-tokenize-review-texts">
<h4>Word tokenize review texts<a class="headerlink" href="#word-tokenize-review-texts" title="Link to this heading">#</a></h4>
<p>I will compute the number of words-tokens in the review texts, this value may capture the interest the book has received.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download nltk necessary package</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;punkt_tab&quot;</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Apply tokenizer to the column, creating a new one with the value</span>
<span class="n">books</span><span class="p">[</span><span class="s2">&quot;review_text_ntokens&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s2">&quot;review/text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">text</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Show result in first rows</span>
<span class="n">books</span><span class="p">[[</span><span class="s2">&quot;review/text&quot;</span><span class="p">,</span> <span class="s2">&quot;review_text_ntokens&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>review/text</th>
      <th>review_text_ntokens</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>I have alway been a fan of fiction books set i...</td>
      <td>105</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Very helpful book to give you a better prayer ...</td>
      <td>25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The message of this book is to find yourself a...</td>
      <td>1375</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The hero of William Bernhardt's Ben Kincaid no...</td>
      <td>430</td>
    </tr>
    <tr>
      <th>4</th>
      <td>There's a lot in this book which the reader wi...</td>
      <td>407</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="split-authors-names">
<h4>Split authors’ names<a class="headerlink" href="#split-authors-names" title="Link to this heading">#</a></h4>
<p>We saw earlier that some authors are composed by more than one name separated by comma. For example:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter records that contain comma and show first</span>
<span class="n">books</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">books</span><span class="p">[</span><span class="s2">&quot;authors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">),</span> <span class="p">[</span><span class="s2">&quot;authors&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>authors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>'Harvey Seymour Gross', 'Robert McDowell'</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To differentiate them, I will split the names by the comma.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split column by comma resulting in list</span>
<span class="n">books</span><span class="p">[</span><span class="s2">&quot;authors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s2">&quot;authors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span>

<span class="c1"># Show result in first rows</span>
<span class="n">books</span><span class="p">[[</span><span class="s2">&quot;authors&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>authors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>['Elizabeth Norman']</td>
    </tr>
    <tr>
      <th>1</th>
      <td>['Yong-gi Cho']</td>
    </tr>
    <tr>
      <th>2</th>
      <td>['Muata Ashby']</td>
    </tr>
    <tr>
      <th>3</th>
      <td>['Lynden Harris']</td>
    </tr>
    <tr>
      <th>4</th>
      <td>['Harvey Seymour Gross', 'Robert McDowell']</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And then I will “explode” this column now composed by lists, transforming each element to a row, replicating index values.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Explode in the &quot;authors&quot; column</span>
<span class="n">books</span> <span class="o">=</span> <span class="n">books</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s2">&quot;authors&quot;</span><span class="p">)</span>

<span class="c1"># Show result in first rows</span>
<span class="n">books</span><span class="p">[[</span><span class="s2">&quot;authors&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>authors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>'Elizabeth Norman'</td>
    </tr>
    <tr>
      <th>1</th>
      <td>'Yong-gi Cho'</td>
    </tr>
    <tr>
      <th>2</th>
      <td>'Muata Ashby'</td>
    </tr>
    <tr>
      <th>3</th>
      <td>'Lynden Harris'</td>
    </tr>
    <tr>
      <th>4</th>
      <td>'Harvey Seymour Gross'</td>
    </tr>
    <tr>
      <th>4</th>
      <td>'Robert McDowell'</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Author names are now untangled.</p>
</section>
<section id="lowercase-categories">
<h4>Lowercase categories<a class="headerlink" href="#lowercase-categories" title="Link to this heading">#</a></h4>
<p>Adjust book categories to lowercase, because some of the entries were repeated in uppercase.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show some of the categories in uppercase</span>
<span class="n">books</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">books</span><span class="p">[</span><span class="s2">&quot;categories&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">isupper</span><span class="p">(),</span> <span class="p">[</span><span class="s2">&quot;categories&quot;</span><span class="p">]][:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>categories</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>576</th>
      <td>'SAP R/3'</td>
    </tr>
    <tr>
      <th>1009</th>
      <td>'FAMILY &amp; RELATIONSHIPS'</td>
    </tr>
    <tr>
      <th>1009</th>
      <td>'FAMILY &amp; RELATIONSHIPS'</td>
    </tr>
    <tr>
      <th>1801</th>
      <td>'COMICS &amp; GRAPHIC NOVELS.'</td>
    </tr>
    <tr>
      <th>1812</th>
      <td>'FICTION'</td>
    </tr>
    <tr>
      <th>1895</th>
      <td>'LANGUAGE ARTS &amp; DISCIPLINES'</td>
    </tr>
    <tr>
      <th>1895</th>
      <td>'LANGUAGE ARTS &amp; DISCIPLINES'</td>
    </tr>
    <tr>
      <th>1895</th>
      <td>'LANGUAGE ARTS &amp; DISCIPLINES'</td>
    </tr>
    <tr>
      <th>2119</th>
      <td>'BIOGRAPHY &amp; AUTOBIOGRAPHY'</td>
    </tr>
    <tr>
      <th>2205</th>
      <td>'SAP R/3'</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert all categories to lowercase</span>
<span class="n">books</span><span class="p">[</span><span class="s2">&quot;categories&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s2">&quot;categories&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="convert-data-types">
<h4>Convert data types<a class="headerlink" href="#convert-data-types" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>I will replace the target variable “popularity” from “Popular” and “Unpopular” to numerical values “0” and “1”.</p></li>
<li><p>I will convert “authors” and “categories” to categorical data types.</p></li>
<li><p>I will drop unnecessary columns for the project: “title”, “description”, “review/summary”, “review/text”.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Replace target variable from category to numerical value</span>
<span class="n">books</span><span class="p">[</span><span class="s2">&quot;popularity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s2">&quot;popularity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">popularity</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">popularity</span> <span class="o">==</span> <span class="s2">&quot;Popular&quot;</span> <span class="k">else</span> <span class="mi">0</span>
<span class="p">)</span>

<span class="c1"># Apply conversion to categorical</span>
<span class="n">books</span><span class="p">[[</span><span class="s2">&quot;authors&quot;</span><span class="p">,</span> <span class="s2">&quot;categories&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">books</span><span class="p">[[</span><span class="s2">&quot;authors&quot;</span><span class="p">,</span> <span class="s2">&quot;categories&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>

<span class="c1"># Drop unnecessary columns</span>
<span class="n">books</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;review/summary&quot;</span><span class="p">,</span> <span class="s2">&quot;review/text&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Show dataframe info</span>
<span class="n">books</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 15275 entries, 0 to 15718
Data columns (total 9 columns):
 #   Column               Non-Null Count  Dtype   
---  ------               --------------  -----   
 0   price                15275 non-null  float64 
 1   authors              15275 non-null  category
 2   categories           15275 non-null  category
 3   popularity           15275 non-null  int64   
 4   helpful_reviews      15275 non-null  int32   
 5   total_reviews        15275 non-null  int32   
 6   review_sum_sent      15275 non-null  float64 
 7   review_text_sent     15275 non-null  float64 
 8   review_text_ntokens  15275 non-null  int64   
dtypes: category(2), float64(3), int32(2), int64(2)
memory usage: 1.2 MB
</pre></div>
</div>
</div>
</div>
<p>We are now ready to test a model for classification.</p>
</section>
</section>
</section>
<section id="classifier">
<h2>Classifier<a class="headerlink" href="#classifier" title="Link to this heading">#</a></h2>
<p>I will define target and features:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define target</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s2">&quot;popularity&quot;</span><span class="p">]</span>

<span class="c1"># Define the features</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">books</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;popularity&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>authors</th>
      <th>categories</th>
      <th>helpful_reviews</th>
      <th>total_reviews</th>
      <th>review_sum_sent</th>
      <th>review_text_sent</th>
      <th>review_text_ntokens</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10.88</td>
      <td>'Elizabeth Norman'</td>
      <td>'history'</td>
      <td>2</td>
      <td>3</td>
      <td>0.6249</td>
      <td>0.8482</td>
      <td>105</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.35</td>
      <td>'Yong-gi Cho'</td>
      <td>'religion'</td>
      <td>0</td>
      <td>0</td>
      <td>0.4754</td>
      <td>0.8955</td>
      <td>25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>24.95</td>
      <td>'Muata Ashby'</td>
      <td>'body, mind &amp; spirit'</td>
      <td>17</td>
      <td>19</td>
      <td>0.0000</td>
      <td>0.9155</td>
      <td>1375</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.99</td>
      <td>'Lynden Harris'</td>
      <td>'social science'</td>
      <td>0</td>
      <td>1</td>
      <td>-0.2960</td>
      <td>-0.2582</td>
      <td>430</td>
    </tr>
    <tr>
      <th>4</th>
      <td>32.50</td>
      <td>'Harvey Seymour Gross'</td>
      <td>'poetry'</td>
      <td>18</td>
      <td>20</td>
      <td>0.4404</td>
      <td>0.9571</td>
      <td>407</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>I will also define a function, based on a Logistic Regression model, that will be used several times later.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">lg_classifier</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Logistic Regression classifier&quot;&quot;&quot;</span>

    <span class="c1"># Scale</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="c1"># Instantiate model</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>

    <span class="c1"># Fit model to the training set</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Predict test set values</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>

    <span class="c1"># Print results</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> &lt;- Test-set accuracy &quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">))</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> &lt;- Train-set accuracy &quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">y_pred</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="one-hot-encoding">
<h3>1) One-hot encoding<a class="headerlink" href="#one-hot-encoding" title="Link to this heading">#</a></h3>
<p>The first approach will be to one-hot encode “authors” and “categories”:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get dummies for features</span>
<span class="n">features_dummied</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="n">features_dummied</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(15275, 8368)
</pre></div>
</div>
</div>
</div>
<p>Due to the high cardinality, it gives us a huge amount of columns. That will probably overfit the model. Let’s check it out.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assign target a features</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">features_dummied</span>

<span class="c1"># Split dataset into training and test set, and stratify</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">lg_classifier</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.63 &lt;- Test-set accuracy 
0.88 &lt;- Train-set accuracy 
</pre></div>
</div>
</div>
</div>
<p>Indeed, it overfits the logistic regression model.</p>
<p>What if we drop categories and use only numeric features?</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define features</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">books</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;popularity&quot;</span><span class="p">,</span> <span class="s2">&quot;authors&quot;</span><span class="p">,</span> <span class="s2">&quot;categories&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Assign target a features</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">features</span>

<span class="c1"># Split dataset into training and test set, and stratify</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">lg_classifier</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.64 &lt;- Test-set accuracy 
0.63 &lt;- Train-set accuracy 
</pre></div>
</div>
</div>
</div>
<p>The model here is not overfitting, confirming the previous problem of the high dimensionality.</p>
<p>Let’s see if we can improve these results.</p>
</section>
<section id="grouping-together-rare-categories">
<h3>2) Grouping together rare categories<a class="headerlink" href="#grouping-together-rare-categories" title="Link to this heading">#</a></h3>
<p>To reduce the dimensionality, let’s group rare authors and rare book categories into a new category name called “other”.</p>
<p>First I will consider a cutoff value to rename a rare author as “other”.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count how many times an author appears</span>
<span class="n">authors_by_freq</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s2">&quot;authors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="c1"># Define a cutoff value to consider an author as rare</span>
<span class="n">freq_cutoff_a</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Create a list of rare (scarce) authors</span>
<span class="n">rare_authors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">author</span> <span class="k">for</span> <span class="n">author</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">authors_by_freq</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">freq</span> <span class="o">&lt;=</span> <span class="n">freq_cutoff_a</span>
<span class="p">]</span>

<span class="c1"># Create a new &quot;authors&quot; feature where rare authors are grouped into a group called &quot;other&quot;</span>
<span class="n">books</span><span class="p">[</span><span class="s2">&quot;authors_rare_grouped&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s2">&quot;authors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">author</span><span class="p">:</span> <span class="s2">&quot;other&quot;</span> <span class="k">if</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">rare_authors</span> <span class="k">else</span> <span class="n">author</span>
<span class="p">)</span>

<span class="c1"># Show results in first rows</span>
<span class="n">books</span><span class="p">[[</span><span class="s2">&quot;authors&quot;</span><span class="p">,</span> <span class="s2">&quot;authors_rare_grouped&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>authors</th>
      <th>authors_rare_grouped</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>'Elizabeth Norman'</td>
      <td>'Elizabeth Norman'</td>
    </tr>
    <tr>
      <th>1</th>
      <td>'Yong-gi Cho'</td>
      <td>other</td>
    </tr>
    <tr>
      <th>2</th>
      <td>'Muata Ashby'</td>
      <td>other</td>
    </tr>
    <tr>
      <th>3</th>
      <td>'Lynden Harris'</td>
      <td>other</td>
    </tr>
    <tr>
      <th>4</th>
      <td>'Harvey Seymour Gross'</td>
      <td>other</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count unique authors</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of unique authors -&gt; </span><span class="si">{</span><span class="n">books</span><span class="p">[</span><span class="s2">&quot;authors_rare_grouped&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of unique authors -&gt; 311
</pre></div>
</div>
</div>
</div>
<p>I will do the same with book categories:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count how many times a category appears</span>
<span class="n">categories_by_freq</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s2">&quot;categories&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="c1"># Define a cutoff value to consider a category as rare</span>
<span class="n">freq_cutoff_c</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Create a list of rare_categories with cutoff</span>
<span class="n">rare_categories</span> <span class="o">=</span> <span class="p">[</span><span class="n">category</span> <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">categories_by_freq</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">freq</span> <span class="o">&lt;=</span> <span class="n">freq_cutoff_c</span><span class="p">]</span>

<span class="c1"># Create a new &quot;categories&quot; feature where rare categories are grouped into a group called &quot;other&quot;</span>
<span class="n">books</span><span class="p">[</span><span class="s2">&quot;categories_rare_grouped&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s2">&quot;categories&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">category</span><span class="p">:</span> <span class="s2">&quot;other&quot;</span> <span class="k">if</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">rare_categories</span> <span class="k">else</span> <span class="n">category</span><span class="p">)</span>

<span class="c1"># Count unique categories</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of unique categories -&gt; </span><span class="si">{</span><span class="n">books</span><span class="p">[</span><span class="s2">&quot;categories_rare_grouped&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of unique categories -&gt; 121
</pre></div>
</div>
</div>
</div>
<p>Let’s model it with one-hot encoding:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define features</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">books</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;popularity&quot;</span><span class="p">,</span> <span class="s2">&quot;authors&quot;</span><span class="p">,</span> <span class="s2">&quot;categories&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Get dummies for features</span>
<span class="n">features_dummied</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>

<span class="c1"># Assign target a features</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">features_dummied</span>

<span class="c1"># Split dataset into training and test set, and stratify</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">lg_classifier</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.65 &lt;- Test-set accuracy 
0.67 &lt;- Train-set accuracy 
</pre></div>
</div>
</div>
</div>
<p>It doesn’t overfit now!</p>
<p>Let’s see if we can further improve results with another approach to deal with categories.</p>
</section>
<section id="target-encoding">
<h3>3) Target encoding<a class="headerlink" href="#target-encoding" title="Link to this heading">#</a></h3>
<p>Let’s transform categorical columns by their target encoding value. It is important to fit the encoding only with training values because otherwise this technique is very prone to data-leakage caused result distortion.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assign target a features</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">features</span>

<span class="c1"># Split dataset into training and test set, and stratify</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="c1"># Initialize TargetEncoder</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">TargetEncoder</span><span class="p">()</span>

<span class="c1"># Create new features with encoded values</span>
<span class="n">X_train</span><span class="p">[[</span><span class="s2">&quot;authors_enc&quot;</span><span class="p">,</span> <span class="s2">&quot;categories_enc&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span>
    <span class="n">X_train</span><span class="p">[[</span><span class="s2">&quot;authors_rare_grouped&quot;</span><span class="p">,</span> <span class="s2">&quot;categories_rare_grouped&quot;</span><span class="p">]],</span> <span class="n">y_train</span>
<span class="p">)</span>
<span class="n">X_test</span><span class="p">[[</span><span class="s2">&quot;authors_enc&quot;</span><span class="p">,</span> <span class="s2">&quot;categories_enc&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
    <span class="n">X_test</span><span class="p">[[</span><span class="s2">&quot;authors_rare_grouped&quot;</span><span class="p">,</span> <span class="s2">&quot;categories_rare_grouped&quot;</span><span class="p">]]</span>
<span class="p">)</span>

<span class="c1"># Drop columns</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;authors_rare_grouped&quot;</span><span class="p">,</span> <span class="s2">&quot;categories_rare_grouped&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;authors_rare_grouped&quot;</span><span class="p">,</span> <span class="s2">&quot;categories_rare_grouped&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Classify</span>
<span class="n">model</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">lg_classifier</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.66 &lt;- Test-set accuracy 
0.66 &lt;- Train-set accuracy 
              precision    recall  f1-score   support

           0       0.68      0.77      0.72      2649
           1       0.62      0.51      0.56      1934

    accuracy                           0.66      4583
   macro avg       0.65      0.64      0.64      4583
weighted avg       0.66      0.66      0.65      4583
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot coefficients</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Logistic Regression model coefficients&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/354c7c0c2d76fbe6063d96e2fe2cbc1cec57e1d76c38c01fbd90fd5870d653b3.png" src="../_images/354c7c0c2d76fbe6063d96e2fe2cbc1cec57e1d76c38c01fbd90fd5870d653b3.png" />
</div>
</div>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>The total number of reviews and the number of helpful reviews appear to be the most predictive features in this project. This aligns with the minimal impact that various processing methods applied to the categorical variables have had.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "my-venv-01"
        },
        kernelOptions: {
            name: "my-venv-01",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'my-venv-01'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="machine-downtime.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Predicting Industrial Machine Downtime</p>
      </div>
    </a>
    <a class="right-next"
       href="internet-patterns.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Analyzing global internet patterns</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-project">The project</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data">The data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-validation">Data validation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-the-data">Read the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-data-quality">Check data quality</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-values">Missing values</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#duplicated-values">Duplicated values</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-value-ranges">Check value ranges</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-data">Categorical data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-data">Numerical data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preprocessing">Data preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#split-review-helpfulness">Split “review/helpfulness”</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sentiment-analysis-in-review-texts">Sentiment analysis in review texts</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#word-tokenize-review-texts">Word tokenize review texts</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#split-authors-names">Split authors’ names</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lowercase-categories">Lowercase categories</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-data-types">Convert data types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classifier">Classifier</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-hot-encoding">1) One-hot encoding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-together-rare-categories">2) Grouping together rare categories</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#target-encoding">3) Target encoding</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mikel Imaz, 2023-2025
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>