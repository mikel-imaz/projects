
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Water Supplies &#8212; Data Projects</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Earth Quakes" href="quakes.html" />
    <link rel="prev" title="Projects" href="../projects.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-232XT3FYCT"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-232XT3FYCT');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Projects</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Data Projects
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../projects.html">
   Projects
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Water Supplies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="quakes.html">
     Earth Quakes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="climate.html">
     Climate Change
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="antio.html">
     Bar Reviews
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="olele.html">
     Handfan Reviews
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="traffic_fines.html">
     Traffic Fines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="urban_trees.html">
     Urban Trees
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="breads.html">
     Bread Prices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ignatian.html">
     Ignatian Pilgrims
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../articles.html">
   Artículos
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../articles/cultura-datos.html">
     Cultura de datos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../articles/datos-valor.html">
     Convertir datos en valor
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://www.linkedin.com/in/mikel-imaz/">
   LinkedIn profile
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.datacamp.com/profile/mikel-imaz">
   DataCamp profile
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/mikel-imaz/projects/master?urlpath=tree/jupyter-book/notebooks/water.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/mikel-imaz/projects"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/water.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background">
   Background
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-data-in-aitzu">
   The data in Aitzu
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-data-in-barrendiola">
   The data in Barrendiola
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stream-in-barrendiola">
   Stream-in Barrendiola
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-reservoir-network">
   The reservoir network
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Water Supplies</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background">
   Background
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-data-in-aitzu">
   The data in Aitzu
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-data-in-barrendiola">
   The data in Barrendiola
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stream-in-barrendiola">
   Stream-in Barrendiola
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-reservoir-network">
   The reservoir network
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="water-supplies">
<h1>Water Supplies<a class="headerlink" href="#water-supplies" title="Permalink to this headline">#</a></h1>
<p><img alt="" src="../_images/barrendiola.jpg" /><br />
<span class="math notranslate nohighlight">\(^{1}\)</span>Reservoir of Barrendiola (14-07-2022).</p>
<p>Apr, 2023</p>
<blockquote>
<div><p><em>Time series analysis, Networks</em></p>
</div></blockquote>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">#</a></h2>
<p>The reservoir that supplies my county is close to the mountains and gets filled easily if it rains. But its capacity is rather low for the needs of the community and the reservoir empties also easily during dry summers.</p>
<p>Last year the weather was hot and dry, and the scarcity of water was clearly visible throughout the valley. Some days I used to go out for a walk down the path by the river, until I reached a bridge. Then, before turning round and heading back home, I would take a look into the flow of the river. The view from the bridge was depressing: there was very little water running down the stream. It was of no surprise that lately I was not spotting any fish there. The trouts, they were all gone. Like in the old days.</p>
<p>Some decades ago, this used to be an extremely polluted river. Then investments were made to build a complete water management system. It involved the control of the whole water cycle in the basin: the aforementioned reservoir (buffer) upstream, sewage treatment plant downstream, and the regulation and maintenance of an ecological-friendly water flow all along the stream. The idea was to have fauna and flora back in the river again.</p>
<p>But was it working?</p>
<p>Close to the bridge where trouts had disappeared, there is a gauging station where some parameters of the water are regularly monitored. These measurements are available online: <a class="reference external" href="https://www.gipuzkoa.eus/es/web/obrahidraulikoak">https://www.gipuzkoa.eus/es/web/obrahidraulikoak</a>. So I decided to take a look at the data.</p>
<p><img alt="" src="../_images/urola.png" /></p>
</section>
<section id="the-data-in-aitzu">
<h2>The data in Aitzu<a class="headerlink" href="#the-data-in-aitzu" title="Permalink to this headline">#</a></h2>
<p>I downloaded daily water flow rates in the river Urola at the gauging station called Aitzu:</p>
<ul class="simple">
<li><p>from <strong>01-07-2022</strong> to <strong>28-02-2023</strong> —8 months.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import packages</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">calendar</span>

<span class="c1"># Read data from file</span>
<span class="n">aitzu</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/aitzu.csv&quot;</span><span class="p">,</span>
                    <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>

<span class="c1"># Convert to m3/s</span>
<span class="n">aitzu</span><span class="p">[</span><span class="s2">&quot;m3/s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aitzu</span><span class="p">[</span><span class="s2">&quot;dm3/s&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">aitzu</span> <span class="o">=</span> <span class="n">aitzu</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;dm3/s&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aitzu</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             m3/s
date             
2022-07-01  0.173
2022-07-02  0.153
2022-07-03  0.146
2022-07-04  0.165
2022-07-05  0.157
...           ...
2023-02-24  2.983
2023-02-25  1.968
2023-02-26  1.740
2023-02-27  1.493
2023-02-28  1.290

[243 rows x 1 columns]
</pre></div>
</div>
</div>
</div>
<p>To evaluate those flow rates I needed to compare them to the minimum requirement. After doing some research, I found out that each gauging station is assigned with a minimum water flow rate, called <em>minimum ecological flow rate</em> (<em><a class="reference external" href="https://www.uragentzia.euskadi.eus/contenidos/informacion/transparencia_gestion/es_def/adjuntos/Informe_Q_ecologicos_2017_2018.pdf">Informe</a> de seguimiento del grado de cumplimiento de los regímenes de caudales ecológicos. Año hidrológico 2017-2018. Ura, ur agentzia. Agencia vasca del agua. Marzo 2019.</em>)</p>
<p>These are the monthly values for Aitzu:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Monthly minimum ecological flowrates for Aitzu</span>
<span class="n">aitzu_min_eco</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Jan&quot;</span><span class="p">:</span> <span class="mf">0.375</span><span class="p">,</span> <span class="s2">&quot;Feb&quot;</span><span class="p">:</span> <span class="mf">0.375</span><span class="p">,</span> <span class="s2">&quot;Mar&quot;</span><span class="p">:</span> <span class="mf">0.375</span><span class="p">,</span> <span class="s2">&quot;Apr&quot;</span><span class="p">:</span> <span class="mf">0.375</span><span class="p">,</span>
                 <span class="s2">&quot;May&quot;</span><span class="p">:</span> <span class="mf">0.244</span><span class="p">,</span> <span class="s2">&quot;Jun&quot;</span><span class="p">:</span> <span class="mf">0.244</span><span class="p">,</span>
                 <span class="s2">&quot;Jul&quot;</span><span class="p">:</span> <span class="mf">0.156</span><span class="p">,</span> <span class="s2">&quot;Aug&quot;</span><span class="p">:</span> <span class="mf">0.156</span><span class="p">,</span> <span class="s2">&quot;Sep&quot;</span><span class="p">:</span> <span class="mf">0.156</span><span class="p">,</span> <span class="s2">&quot;Oct&quot;</span><span class="p">:</span> <span class="mf">0.156</span><span class="p">,</span>
                 <span class="s2">&quot;Nov&quot;</span><span class="p">:</span> <span class="mf">0.244</span><span class="p">,</span> <span class="s2">&quot;Dec&quot;</span><span class="p">:</span> <span class="mf">0.244</span><span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">aitzu_min_eco</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Jan&#39;: 0.375, &#39;Feb&#39;: 0.375, &#39;Mar&#39;: 0.375, &#39;Apr&#39;: 0.375, &#39;May&#39;: 0.244, &#39;Jun&#39;: 0.244, &#39;Jul&#39;: 0.156, &#39;Aug&#39;: 0.156, &#39;Sep&#39;: 0.156, &#39;Oct&#39;: 0.156, &#39;Nov&#39;: 0.244, &#39;Dec&#39;: 0.244}
</pre></div>
</div>
</div>
</div>
<p>To facilitate the comparison, I calculate monthly average values of the actual flow rate and plot the results.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert the data into a pandas dataframe</span>
<span class="n">aitzu_eco</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">aitzu_min_eco</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                         <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;m3/s&quot;</span><span class="p">])</span>

<span class="c1"># Attach new column in the Aitzu df with monthly minimum ecological flowrate</span>
<span class="n">aitzu</span><span class="p">[</span><span class="s2">&quot;monthly_eco&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">aitzu_eco</span><span class="p">[</span><span class="s2">&quot;m3/s&quot;</span><span class="p">][</span><span class="n">aitzu</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">month</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aitzu</span><span class="p">))]</span>

<span class="c1"># Calculate mean value for each month</span>
<span class="n">aitzu_monthly_avg</span> <span class="o">=</span> <span class="n">aitzu</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">aitzu</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="p">)[</span><span class="s2">&quot;m3/s&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<span class="n">aitzu_monthly_avg</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;month&quot;</span>

<span class="c1"># Create new column with mean value of the month</span>
<span class="n">aitzu</span><span class="p">[</span><span class="s2">&quot;monthly_avg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">aitzu_monthly_avg</span><span class="p">[</span><span class="s2">&quot;m3/s&quot;</span><span class="p">][</span><span class="n">aitzu</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">month</span><span class="p">]</span> \
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aitzu</span><span class="p">))]</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">aitzu</span><span class="p">[</span><span class="s2">&quot;m3/s&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Daily (m3/s)&quot;</span><span class="p">)</span>
<span class="n">aitzu</span><span class="p">[</span><span class="s2">&quot;monthly_avg&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Monthly average&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">aitzu</span><span class="p">[</span><span class="s2">&quot;monthly_eco&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ecological minimum&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Streamflow at Aitzu gauging station&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;m3/s&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/water_10_0.png" src="../_images/water_10_0.png" />
</div>
</div>
<p>The graph shows that throughout the last summer and well into the middle of the autumn, the regular flow of water was barely enough to abide by the minimum ecological requirements: the average values in August and October were below the line, and in July and September they were scarcely above.</p>
<p>It looks poor, although not as terrible as I thought. However, the fish disapeared, I can assure you. Maybe there were other reasons, but reaching the minimum ecological flow requirements seems necessary to preserve natural life.</p>
<p>Now the question was:</p>
<ul class="simple">
<li><p>Would it have been possible to get the needed extra water from the reservoir?</p></li>
</ul>
<p>(I am going to assume that there are no losses between the reservoir and the gauging station, which is located several kilometres downstream. This is not realistic, but I will assume that for simplicity —and because I have no idea how much would losses account for).</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate additional flow rate needed to reach ecological minimum</span>
<span class="n">deltas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">efficiency</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">aitzu_monthly_avg</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">aitzu_eco</span><span class="p">[</span><span class="s2">&quot;m3/s&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">aitzu_monthly_avg</span><span class="p">[</span><span class="s2">&quot;m3/s&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">deltas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">delta</span> <span class="o">/</span> <span class="n">efficiency</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;In </span><span class="si">{</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_abbr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">delta</span> <span class="o">/</span> <span class="n">efficiency</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> m3/s extra needed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">deltas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
<span class="c1"># Insert new column with the water flow needed from Barrendiola</span>
<span class="n">aitzu_monthly_avg</span><span class="p">[</span><span class="s2">&quot;barren_m3/s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deltas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>In Aug -&gt; 0.045 m3/s extra needed
In Oct -&gt; 0.026 m3/s extra needed
</pre></div>
</div>
</div>
</div>
<p>Let’s see how this extra demand for water would have affected the volumes of the reservoir.</p>
</section>
<section id="the-data-in-barrendiola">
<h2>The data in Barrendiola<a class="headerlink" href="#the-data-in-barrendiola" title="Permalink to this headline">#</a></h2>
<p>I downloaded the information about the evolution of the water reserves in the reservoir in this website: <a class="reference external" href="https://www.gipuzkoakour.eus/">https://www.gipuzkoakour.eus/</a></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read data from file</span>
<span class="n">barrendiola</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/barrendiola.csv&quot;</span><span class="p">,</span>
                          <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">barrendiola</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             hm3  normal  prealerta  alerta  emergencia  lowest
date                                                           
2022-06-23  1.32    1.48       1.40    1.33        1.26    1.21
2022-07-03  1.25    1.48       1.37    1.27        1.20    1.13
2022-07-13  1.22    1.48       1.34    1.23        1.13    1.07
2022-07-23  1.16    1.48       1.30    1.17        1.09    1.00
2022-08-02  1.11    1.48       1.26    1.12        1.03    0.93
</pre></div>
</div>
</div>
</div>
<p>As the data was not available daily, I had to interpolate the values to fill in the gaps.</p>
<p>The following graph shows the evolution of the water volume, the actual one and in the hypothetical case the extra water had been extracted.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set frequency as daily and interpolate to fill in gaps</span>
<span class="n">barrendiola</span> <span class="o">=</span> <span class="n">barrendiola</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>

<span class="c1"># Select values from Jul 2022 to end of Feb 2023</span>
<span class="n">barrendiola</span> <span class="o">=</span> <span class="n">barrendiola</span><span class="p">[(</span><span class="n">barrendiola</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="s2">&quot;2022-07-01&quot;</span><span class="p">)</span> \
                          <span class="o">&amp;</span> <span class="p">(</span><span class="n">barrendiola</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="s2">&quot;2023-02-28&quot;</span><span class="p">)]</span>

<span class="c1"># Create new column with demanded flow output</span>
<span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;m3/s_out&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">aitzu_monthly_avg</span><span class="p">[</span><span class="s2">&quot;barren_m3/s&quot;</span><span class="p">][</span><span class="n">barrendiola</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">month</span><span class="p">]</span> \
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">barrendiola</span><span class="p">))]</span>

<span class="c1"># Create new column with demanded volume output</span>
<span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;hm3_out&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;m3/s_out&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">/</span> <span class="mi">1000000</span>

<span class="c1"># Create new column with accumulated volume output</span>
<span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;hm3_out_cum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;hm3_out&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

<span class="c1"># Create new column with hypothetical reservoir volumes</span>
<span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;hm3_new&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;hm3&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;hm3_out_cum&quot;</span><span class="p">]</span>

<span class="c1"># Locate and reassign values when reservoir is full</span>
<span class="n">barrendiola</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">barrendiola</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="s2">&quot;2023-01-20&quot;</span><span class="p">,</span> <span class="s2">&quot;hm3_new&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="c1">#Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;hm3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Actual volume&quot;</span><span class="p">)</span>
<span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;hm3_new&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Hypothetical volume&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">barrendiola</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;prealerta&quot;</span><span class="p">],</span> <span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;normal&quot;</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Normal&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">barrendiola</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;alerta&quot;</span><span class="p">],</span> <span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;prealerta&quot;</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Prealerta&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">barrendiola</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;emergencia&quot;</span><span class="p">],</span> <span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;alerta&quot;</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Alerta&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">barrendiola</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;lowest&quot;</span><span class="p">],</span> <span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;emergencia&quot;</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Emergencia&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Water reserve in Barrendiola&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;hm3&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">barrendiola_full</span> <span class="o">=</span> <span class="mf">1.482</span> <span class="c1"># Full capacity of Barrendiola in hm3</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Full capacity</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">barrendiola_full</span><span class="si">}</span><span class="s2"> hm3&quot;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2023-01-18&quot;</span><span class="p">,</span> <span class="mf">1.475</span><span class="p">),</span> 
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2022-12-01&quot;</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;arrowstyle&quot;</span><span class="p">:</span><span class="s2">&quot;-|&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span><span class="s2">&quot;black&quot;</span><span class="p">})</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2023-01-23&quot;</span><span class="p">,</span> <span class="mf">1.49</span><span class="p">),</span> 
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;2023-01-19&quot;</span><span class="p">,</span> <span class="mf">1.299</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;arrowstyle&quot;</span><span class="p">:</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;linestyle&quot;</span><span class="p">:</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span><span class="s2">&quot;black&quot;</span><span class="p">})</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/water_17_0.png" src="../_images/water_17_0.png" />
</div>
</div>
<p>The difference is remarkable! Initially it did not seem we were asking for so much water, but definitely it affects the water reserves in an already limited reservoir that just barely meets the needs of the community.</p>
</section>
<section id="stream-in-barrendiola">
<h2>Stream-in Barrendiola<a class="headerlink" href="#stream-in-barrendiola" title="Permalink to this headline">#</a></h2>
<p>The main stream that feeds Barrendiola has a gauging station right before the entrance to the reservoir. I downloaded the data to see how much water was provided during the time period. I also took a look at the rainfall during those months.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read data from file</span>
<span class="n">barrendiola_in</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/barrendiola-in.csv&quot;</span><span class="p">,</span>
                             <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>

<span class="c1"># Convert to m3/s</span>
<span class="n">barrendiola_in</span><span class="p">[</span><span class="s2">&quot;m3/s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">barrendiola_in</span><span class="p">[</span><span class="s2">&quot;dm3/s&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1000</span>
<span class="n">barrendiola_in</span> <span class="o">=</span> <span class="n">barrendiola_in</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;dm3/s&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">barrendiola_in</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            rainfall   m3/s
date                       
2022-07-01       0.0  0.012
2022-07-02       0.0  0.012
2022-07-03       3.4  0.010
2022-07-04       1.3  0.010
2022-07-05       0.3  0.009
...              ...    ...
2023-02-24       8.8  0.078
2023-02-25       2.4  0.074
2023-02-26       1.5  0.078
2023-02-27       0.1  0.067
2023-02-28       5.4  0.059

[243 rows x 2 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">barrendiola_in</span><span class="p">[</span><span class="s2">&quot;m3/s&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Daily supply into reservoir&quot;</span><span class="p">)</span>

<span class="n">barrendiola</span><span class="p">[</span><span class="s2">&quot;m3/s_out&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                             <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Desired extra output&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Stream supplying Barrendiola&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;m3/s&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/water_22_0.png" src="../_images/water_22_0.png" />
</div>
</div>
<p>The graph clearly shows that the stream by itself cannot cope with the extra amount that is being asked.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">barrendiola_in</span><span class="p">[</span><span class="s2">&quot;rainfall&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightseagreen&quot;</span><span class="p">,</span>
                                     <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Daily rainfall (mm)&quot;</span><span class="p">)</span>
 
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Rainfall in Barrendiola&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;mm&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/water_24_0.png" src="../_images/water_24_0.png" />
</div>
</div>
<p>Rainfall is depicted just for information. Rain is also contributing to the reservoir, though is hard to say to what extend. Also, when it rains, several other streams flow into the reservoir making it even more difficult to deduce the amounts.</p>
<p>Does the reservoir have any other source of water?</p>
<p>Yes, it has!</p>
</section>
<section id="the-reservoir-network">
<h2>The reservoir network<a class="headerlink" href="#the-reservoir-network" title="Permalink to this headline">#</a></h2>
<p>To respond to emergency demands, various reservoirs in the province were connected between each other.</p>
<p><img alt="" src="../_images/embalses.png" /></p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters of the reservoirs</span>
<span class="n">reservoirs_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;reservoir&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Aixola&quot;</span><span class="p">,</span> <span class="s2">&quot;Barrendiola&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Urkulu&quot;</span><span class="p">,</span> <span class="s2">&quot;Lareo&quot;</span><span class="p">,</span> <span class="s2">&quot;Ibai-eder&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Arriaran&quot;</span><span class="p">,</span> <span class="s2">&quot;Ibiur&quot;</span><span class="p">],</span>
                  <span class="s2">&quot;vol_hm3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.726</span><span class="p">,</span> <span class="mf">1.482</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">2.23</span><span class="p">,</span> <span class="mf">11.3</span><span class="p">,</span> <span class="mf">3.013</span><span class="p">,</span> <span class="mf">7.575</span><span class="p">],</span>
                  <span class="s2">&quot;alt_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">306</span><span class="p">,</span> <span class="mi">543</span><span class="p">,</span> <span class="mi">328</span><span class="p">,</span> <span class="mi">740</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">281</span><span class="p">,</span> <span class="mi">162</span><span class="p">]}</span>

<span class="c1"># Convert to dafaframe</span>
<span class="n">reservoirs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reservoirs_dic</span><span class="p">)</span>\
            <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;vol_hm3&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;reservoir&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">reservoirs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             vol_hm3  alt_m
reservoir                  
Ibai-eder     11.300    221
Urkulu        10.000    328
Ibiur          7.575    162
Arriaran       3.013    281
Aixola         2.726    306
Lareo          2.230    740
Barrendiola    1.482    543
</pre></div>
</div>
</div>
</div>
<p>In the list above, we can see that Barrendiola is the smallest reservoir at the group. And the one that is connected to, Ibai-eder, the biggest one.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Connections</span>
<span class="n">connections_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;from&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Ibai-eder&quot;</span><span class="p">,</span> <span class="s2">&quot;Arriaran&quot;</span><span class="p">,</span> <span class="s2">&quot;Arriaran&quot;</span><span class="p">,</span> <span class="s2">&quot;Urkulu&quot;</span><span class="p">],</span>
                   <span class="s2">&quot;to&quot;</span><span class="p">:[</span><span class="s2">&quot;Barrendiola&quot;</span><span class="p">,</span> <span class="s2">&quot;Lareo&quot;</span><span class="p">,</span> <span class="s2">&quot;Ibiur&quot;</span><span class="p">,</span> <span class="s2">&quot;Aixola&quot;</span><span class="p">],</span>
                   <span class="s2">&quot;km&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">15.9</span><span class="p">,</span> <span class="mf">14.5</span><span class="p">,</span> <span class="mf">9.3</span><span class="p">,</span> <span class="mf">15.3</span><span class="p">]}</span>

<span class="c1"># Convert to dafaframe</span>
<span class="n">connections</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">connections_dic</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">connections</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        from           to    km
0  Ibai-eder  Barrendiola  15.9
1   Arriaran        Lareo  14.5
2   Arriaran        Ibiur   9.3
3     Urkulu       Aixola  15.3
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import network package</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>

<span class="c1"># Create a graph</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>

<span class="c1"># Add nodes</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">reservoirs</span><span class="p">)):</span>
    <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">reservoirs</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
               <span class="n">vol_hm3</span><span class="o">=</span><span class="n">reservoirs</span><span class="p">[</span><span class="s2">&quot;vol_hm3&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
               <span class="n">alt_m</span><span class="o">=</span><span class="n">reservoirs</span><span class="p">[</span><span class="s2">&quot;alt_m&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

<span class="c1"># # Show nodes with metadata</span>
<span class="c1"># G.nodes(data=True)</span>

<span class="c1"># Add edges</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">connections</span><span class="p">)):</span>
    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">connections</span><span class="p">[</span><span class="s2">&quot;from&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">connections</span><span class="p">[</span><span class="s2">&quot;to&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
               <span class="n">dist_km</span><span class="o">=</span><span class="n">connections</span><span class="p">[</span><span class="s2">&quot;km&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
               <span class="n">alt_diff</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">reservoirs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">connections</span><span class="p">[</span><span class="s2">&quot;from&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]][</span><span class="s2">&quot;alt_m&quot;</span><span class="p">]</span> \
                            <span class="o">-</span> <span class="n">reservoirs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">connections</span><span class="p">[</span><span class="s2">&quot;to&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]][</span><span class="s2">&quot;alt_m&quot;</span><span class="p">]))</span>

<span class="c1"># # Show edges with metadata</span>
<span class="c1"># G.edges(data=True)</span>

<span class="c1"># Node size proportional to reservoir volume</span>
<span class="n">node_size</span> <span class="o">=</span> <span class="p">[</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;vol_hm3&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()]</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">800</span> <span class="c1"># default 300</span>
<span class="n">node_size_scaled</span> <span class="o">=</span> <span class="n">reservoirs</span><span class="p">[</span><span class="s2">&quot;vol_hm3&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">scale</span>

<span class="c1"># Layout of the graph</span>
<span class="n">pos_x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">pos</span> <span class="o">=</span> <span class="p">{</span><span class="n">n</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s2">&quot;alt_m&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span> <span class="n">pos_x</span><span class="p">)}</span>

<span class="c1"># Edge list</span>
<span class="n">edgelist</span> <span class="o">=</span> <span class="p">[(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()]</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                       <span class="n">node_size</span><span class="o">=</span><span class="n">node_size_scaled</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
                        <span class="n">font_weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="n">node_size</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">edgelist</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># nx.draw_networkx_edge_labels(G, pos, ax=ax,</span>
<span class="c1">#                             edge_labels=nx.get_edge_attributes(G, &quot;dist_km&quot;),</span>
<span class="c1">#                             font_size=10)</span>
 
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;altitude (m)&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">580</span><span class="p">,</span> <span class="s2">&quot;Barrendiola&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/water_31_0.png" src="../_images/water_31_0.png" />
</div>
</div>
<p>So this is how I imagine the system: Barrendiola, which is located close to the mountains and at a relatively high altitude, gets a lot of water during the winter and spring. As it is small, it gets full easily and lets through a lot of water. This exceeding water could therefore be stored in the large Ibai-eder reservoir. Then, during the summers and autumns, Ibai-eder would give back to Barrendiola some of its water. And maybe, that way there would be enough resources to maintain a minimum ecological flow rate in the river Urola.</p>
<p>But I do not know about all this. Unfortunately, I was not able to get any information about water transfers between reservoirs. I suppose there are constraints also, and associated energy costs as well.</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">#</a></h2>
<p>In this project I analysed the data available online to learn about the figures relating the water supply in my community. The system looks quite limited in capacity for the dry months, especially considering the climate change and the hotter and presumably drier summers expected in the future. I hope that there is some plan on the part of the local governments to ensure a minimum flow that allows there to be fish in the river in a sustainable manner. I am going to miss the trouts otherwise.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../projects.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Projects</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="quakes.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Earth Quakes</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Mikel Imaz, 2023<br/>
  
    <div class="extra_footer">
      <p>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
</p>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>