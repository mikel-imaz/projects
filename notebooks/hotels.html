
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Predicting hotel cancellations &#8212; Data Projects</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-232XT3FYCT"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-232XT3FYCT');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Projects</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Data Projects
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../projects-my.html">
   Personal projects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ages.html">
     Median Ages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="water.html">
     Water Supplies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="quakes.html">
     Earth Quakes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="climate.html">
     Climate Change
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="antio.html">
     Bar Reviews
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="olele.html">
     Handfan Reviews
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="traffic_fines.html">
     Traffic Fines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="urban_trees.html">
     Urban Trees
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="breads.html">
     Bread Prices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ignatian.html">
     Ignatian Pilgrims
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../projects-challenge.html">
   Challenge projects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="hospital.html">
     Reducing hospital readmissions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../articles.html">
   Artículos
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../articles/cultura-datos.html">
     La importancia de adquirir competencias en materia de datos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../articles/datos-valor.html">
     La ciencia de convertir los datos en valor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../articles/ia.html">
     ¿Qué es la Inteligencia Artificial?
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://www.linkedin.com/in/mikel-imaz/">
   LinkedIn profile
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.datacamp.com/profile/mikel-imaz">
   DataCamp profile
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/mikel-imaz/projects/master?urlpath=tree/jupyter-book/notebooks/hotels.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/mikel-imaz/projects"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/hotels.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-project">
   The project
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-data">
   The data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-validation">
   Data validation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#duplicates">
     Duplicates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#missing-values">
     Missing values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-consistency">
     Data consistency
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-ranges">
     Data ranges
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-types">
     Data types
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analysis">
   Exploratory Data Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-proportion-of-target-variable">
     Inspecting proportion of target variable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-dates">
     Inspecting by dates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-month">
     Inspecting by month
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-week-day">
     Inspecting by week day
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-lead-time">
     Inspecting by lead time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-repeated-guest-and-previous-cancelations">
     Inspecting by repeated guest and previous cancelations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-number-of-adults-and-children">
     Inspecting by number of adults and children
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-number-of-week-and-weekdend-nights">
     Inspecting by number of week and weekdend nights
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-required-car-parking-space">
     Inspecting by required car parking space
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-number-of-special-requests">
     Inspecting by number of special requests
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspect-by-average-price-per-room">
     Inspect by average price per room
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspect-by-market-segment-type">
     Inspect by market segment type
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspect-by-room-type">
     Inspect by room type
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspect-by-meal-type">
     Inspect by meal type
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modelling">
   Modelling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-preprocessing">
     Data preprocessing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#logistic-regression">
     Logistic Regression
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#knn">
     kNN
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decision-trees">
     Decision Trees
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Predicting hotel cancellations</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-project">
   The project
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-data">
   The data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-validation">
   Data validation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#duplicates">
     Duplicates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#missing-values">
     Missing values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-consistency">
     Data consistency
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-ranges">
     Data ranges
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-types">
     Data types
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analysis">
   Exploratory Data Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-proportion-of-target-variable">
     Inspecting proportion of target variable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-dates">
     Inspecting by dates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-month">
     Inspecting by month
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-week-day">
     Inspecting by week day
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-lead-time">
     Inspecting by lead time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-repeated-guest-and-previous-cancelations">
     Inspecting by repeated guest and previous cancelations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-number-of-adults-and-children">
     Inspecting by number of adults and children
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-number-of-week-and-weekdend-nights">
     Inspecting by number of week and weekdend nights
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-required-car-parking-space">
     Inspecting by required car parking space
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspecting-by-number-of-special-requests">
     Inspecting by number of special requests
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspect-by-average-price-per-room">
     Inspect by average price per room
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspect-by-market-segment-type">
     Inspect by market segment type
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspect-by-room-type">
     Inspect by room type
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspect-by-meal-type">
     Inspect by meal type
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modelling">
   Modelling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-preprocessing">
     Data preprocessing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#logistic-regression">
     Logistic Regression
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#knn">
     kNN
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decision-trees">
     Decision Trees
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="predicting-hotel-cancellations">
<h1>Predicting hotel cancellations<a class="headerlink" href="#predicting-hotel-cancellations" title="Permalink to this headline">#</a></h1>
<p><em><a class="reference external" href="https://app.datacamp.com/learn/competitions">A DataCamp challenge</a></em></p>
<p><img alt="" src="../_images/predict-hotel-cancellation.jpg" /></p>
<section id="the-project">
<h2>The project<a class="headerlink" href="#the-project" title="Permalink to this headline">#</a></h2>
<p>You are supporting a hotel with a project aimed to increase revenue from their room bookings. They believe that they can use data science to help them reduce the number of cancellations. This is where you come in!</p>
<p>They have asked you to use any appropriate methodology to identify what contributes to whether a booking will be fulfilled or cancelled. They intend to use the results of your work to reduce the chance someone cancels their booking.</p>
<p>Produce recommendations for the hotel on what factors affect whether customers cancel their booking.</p>
</section>
<section id="the-data">
<h2>The data<a class="headerlink" href="#the-data" title="Permalink to this headline">#</a></h2>
<p>They have provided you with their bookings data in a file called <code class="docutils literal notranslate"><span class="pre">hotel_bookings.csv</span></code>, which contains the following:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Booking_ID</span></code></p></td>
<td><p>Unique identifier of the booking.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">no_of_adults</span></code></p></td>
<td><p>The number of adults.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">no_of_children</span></code></p></td>
<td><p>The number of children.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">no_of_weekend_nights</span></code></p></td>
<td><p>Number of weekend nights (Saturday or Sunday).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">no_of_week_nights</span></code></p></td>
<td><p>Number of week nights (Monday to Friday).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">type_of_meal_plan</span></code></p></td>
<td><p>Type of meal plan included in the booking.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">required_car_parking_space</span></code></p></td>
<td><p>Whether a car parking space is required.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">room_type_reserved</span></code></p></td>
<td><p>The type of room reserved.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lead_time</span></code></p></td>
<td><p>Number of days before the arrival date the booking was made.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">arrival_year</span></code></p></td>
<td><p>Year of arrival.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">arrival_month</span></code></p></td>
<td><p>Month of arrival.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">arrival_date</span></code></p></td>
<td><p>Date of the month for arrival.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">market_segment_type</span></code></p></td>
<td><p>How the booking was made.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">repeated_guest</span></code></p></td>
<td><p>Whether the guest has previously stayed at the hotel.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">no_of_previous_cancellations</span></code></p></td>
<td><p>Number of previous cancellations.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">no_of_previous_bookings_not_canceled</span></code></p></td>
<td><p>Number of previous bookings that were canceled.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">avg_price_per_room</span></code></p></td>
<td><p>Average price per day of the booking.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">no_of_special_requests</span></code></p></td>
<td><p>Count of special requests made as part of the booking.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">booking_status</span></code></p></td>
<td><p>Whether the booking was cancelled or not.</p></td>
</tr>
</tbody>
</table>
<p>Source (data has been modified): <a class="reference external" href="https://www.kaggle.com/datasets/ahsan81/hotel-reservations-classification-dataset">https://www.kaggle.com/datasets/ahsan81/hotel-reservations-classification-dataset</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import packages</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">calendar</span>

<span class="kn">import</span> <span class="nn">missingno</span> <span class="k">as</span> <span class="nn">msno</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the data from file</span>
<span class="n">hotels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/hotel_bookings.csv&quot;</span><span class="p">)</span>
<span class="n">hotels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Booking_ID</th>
      <th>no_of_adults</th>
      <th>no_of_children</th>
      <th>no_of_weekend_nights</th>
      <th>no_of_week_nights</th>
      <th>type_of_meal_plan</th>
      <th>required_car_parking_space</th>
      <th>room_type_reserved</th>
      <th>lead_time</th>
      <th>arrival_year</th>
      <th>arrival_month</th>
      <th>arrival_date</th>
      <th>market_segment_type</th>
      <th>repeated_guest</th>
      <th>no_of_previous_cancellations</th>
      <th>no_of_previous_bookings_not_canceled</th>
      <th>avg_price_per_room</th>
      <th>no_of_special_requests</th>
      <th>booking_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>INN00001</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>1</th>
      <td>INN00002</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>Not Selected</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>5.0</td>
      <td>2018.0</td>
      <td>11.0</td>
      <td>6.0</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>106.68</td>
      <td>1.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>2</th>
      <td>INN00003</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>1.0</td>
      <td>2018.0</td>
      <td>2.0</td>
      <td>28.0</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>60.00</td>
      <td>0.0</td>
      <td>Canceled</td>
    </tr>
    <tr>
      <th>3</th>
      <td>INN00004</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>211.0</td>
      <td>2018.0</td>
      <td>5.0</td>
      <td>20.0</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>0.0</td>
      <td>Canceled</td>
    </tr>
    <tr>
      <th>4</th>
      <td>INN00005</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>Not Selected</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>48.0</td>
      <td>2018.0</td>
      <td>4.0</td>
      <td>11.0</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>94.50</td>
      <td>0.0</td>
      <td>Canceled</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>36270</th>
      <td>INN36271</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>85.0</td>
      <td>2018.0</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>Online</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>167.80</td>
      <td>1.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>36271</th>
      <td>INN36272</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>228.0</td>
      <td>2018.0</td>
      <td>10.0</td>
      <td>17.0</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>90.95</td>
      <td>2.0</td>
      <td>Canceled</td>
    </tr>
    <tr>
      <th>36272</th>
      <td>INN36273</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>148.0</td>
      <td>2018.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>98.39</td>
      <td>2.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>36273</th>
      <td>INN36274</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>Not Selected</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>63.0</td>
      <td>2018.0</td>
      <td>4.0</td>
      <td>21.0</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>94.50</td>
      <td>0.0</td>
      <td>Canceled</td>
    </tr>
    <tr>
      <th>36274</th>
      <td>INN36275</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>Meal Plan 1</td>
      <td>NaN</td>
      <td>Room_Type 1</td>
      <td>207.0</td>
      <td>2018.0</td>
      <td>12.0</td>
      <td>30.0</td>
      <td>Offline</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>161.67</td>
      <td>0.0</td>
      <td>Not_Canceled</td>
    </tr>
  </tbody>
</table>
<p>36275 rows × 19 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Store initial shape</span>
<span class="n">hotels_init_shape</span> <span class="o">=</span> <span class="n">hotels</span><span class="o">.</span><span class="n">shape</span>

<span class="c1"># Inspect the dataframe</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 36275 entries, 0 to 36274
Data columns (total 19 columns):
 #   Column                                Non-Null Count  Dtype  
---  ------                                --------------  -----  
 0   Booking_ID                            36275 non-null  object 
 1   no_of_adults                          35862 non-null  float64
 2   no_of_children                        35951 non-null  float64
 3   no_of_weekend_nights                  35908 non-null  float64
 4   no_of_week_nights                     35468 non-null  float64
 5   type_of_meal_plan                     35749 non-null  object 
 6   required_car_parking_space            33683 non-null  float64
 7   room_type_reserved                    35104 non-null  object 
 8   lead_time                             35803 non-null  float64
 9   arrival_year                          35897 non-null  float64
 10  arrival_month                         35771 non-null  float64
 11  arrival_date                          35294 non-null  float64
 12  market_segment_type                   34763 non-null  object 
 13  repeated_guest                        35689 non-null  float64
 14  no_of_previous_cancellations          35778 non-null  float64
 15  no_of_previous_bookings_not_canceled  35725 non-null  float64
 16  avg_price_per_room                    35815 non-null  float64
 17  no_of_special_requests                35486 non-null  float64
 18  booking_status                        36275 non-null  object 
dtypes: float64(14), object(5)
memory usage: 5.3+ MB
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-validation">
<h2>Data validation<a class="headerlink" href="#data-validation" title="Permalink to this headline">#</a></h2>
<section id="duplicates">
<h3>Duplicates<a class="headerlink" href="#duplicates" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look for duplicate rows</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>There are no duplicates, but because of the unique identifier for each row.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look for duplicate rows excluding first column unique identifier</span>
<span class="n">subset_cols</span> <span class="o">=</span> <span class="n">hotels</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="c1"># Check for duplicates using subset of columns</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">subset_cols</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7445
</pre></div>
</div>
</div>
</div>
<p>So there are indeed complete duplicates. I will remove them because they convey no extra information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop duplicated rows keeping only the last</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">subset_cols</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Check again for duplicates using subset of columns</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">subset_cols</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>Let’s look at duplicates of a certain subset of columns that I have selected, looking for repeated entries possibly made by mistake.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look for duplicates in a subset of columns</span>
<span class="n">subset_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lead_time&#39;</span><span class="p">,</span> <span class="s1">&#39;arrival_year&#39;</span><span class="p">,</span> <span class="s1">&#39;arrival_month&#39;</span><span class="p">,</span> <span class="s1">&#39;arrival_date&#39;</span><span class="p">,</span> <span class="s1">&#39;avg_price_per_room&#39;</span><span class="p">]</span>

<span class="c1"># Check again for duplicates using subset of columns</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">subset_cols</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3627
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the duplicated rows keeping the duplicates</span>
<span class="n">hotels</span><span class="p">[</span><span class="n">hotels</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">subset_cols</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">subset_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Booking_ID</th>
      <th>no_of_adults</th>
      <th>no_of_children</th>
      <th>no_of_weekend_nights</th>
      <th>no_of_week_nights</th>
      <th>type_of_meal_plan</th>
      <th>required_car_parking_space</th>
      <th>room_type_reserved</th>
      <th>lead_time</th>
      <th>arrival_year</th>
      <th>arrival_month</th>
      <th>arrival_date</th>
      <th>market_segment_type</th>
      <th>repeated_guest</th>
      <th>no_of_previous_cancellations</th>
      <th>no_of_previous_bookings_not_canceled</th>
      <th>avg_price_per_room</th>
      <th>no_of_special_requests</th>
      <th>booking_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23007</th>
      <td>INN23008</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 5</td>
      <td>0.0</td>
      <td>2017.0</td>
      <td>7.0</td>
      <td>29.0</td>
      <td>Complementary</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>2.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>24146</th>
      <td>INN24147</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>0.0</td>
      <td>2017.0</td>
      <td>7.0</td>
      <td>29.0</td>
      <td>Complementary</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>988</th>
      <td>INN00989</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 4</td>
      <td>0.0</td>
      <td>2017.0</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>Complementary</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>12627</th>
      <td>INN12628</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>0.0</td>
      <td>2017.0</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>Complementary</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>15260</th>
      <td>INN15261</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>Not Selected</td>
      <td>NaN</td>
      <td>Room_Type 1</td>
      <td>0.0</td>
      <td>2017.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>80.00</td>
      <td>1.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>24486</th>
      <td>INN24487</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>Meal Plan 1</td>
      <td>NaN</td>
      <td>Room_Type 1</td>
      <td>NaN</td>
      <td>2018.0</td>
      <td>9.0</td>
      <td>26.0</td>
      <td>Offline</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>99.00</td>
      <td>0.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>28875</th>
      <td>INN28876</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>NaN</td>
      <td>2018.0</td>
      <td>10.0</td>
      <td>5.0</td>
      <td>Offline</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>78.20</td>
      <td>0.0</td>
      <td>Canceled</td>
    </tr>
    <tr>
      <th>29414</th>
      <td>INN29415</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>Meal Plan 1</td>
      <td>NaN</td>
      <td>Room_Type 1</td>
      <td>NaN</td>
      <td>2018.0</td>
      <td>10.0</td>
      <td>5.0</td>
      <td>Offline</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>78.20</td>
      <td>0.0</td>
      <td>Canceled</td>
    </tr>
    <tr>
      <th>12012</th>
      <td>INN12013</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>Meal Plan 1</td>
      <td>NaN</td>
      <td>Room_Type 1</td>
      <td>NaN</td>
      <td>2018.0</td>
      <td>10.0</td>
      <td>22.0</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>80.75</td>
      <td>0.0</td>
      <td>Canceled</td>
    </tr>
    <tr>
      <th>12089</th>
      <td>INN12090</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>NaN</td>
      <td>2018.0</td>
      <td>10.0</td>
      <td>22.0</td>
      <td>Offline</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>80.75</td>
      <td>0.0</td>
      <td>Not_Canceled</td>
    </tr>
  </tbody>
</table>
<p>5921 rows × 19 columns</p>
</div></div></div>
</div>
<p>After all, I consider that these duplicates do not necessarily come from wrongly repeated entries. That could be the case if customer names were repeated, but there is nothing like that, so I will leave them.</p>
</section>
<section id="missing-values">
<h3>Missing values<a class="headerlink" href="#missing-values" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check for missing values</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>required_car_parking_space              2465
market_segment_type                     1486
room_type_reserved                      1137
arrival_date                             946
no_of_week_nights                        788
no_of_special_requests                   782
repeated_guest                           575
no_of_previous_bookings_not_canceled     547
type_of_meal_plan                        519
arrival_month                            503
no_of_previous_cancellations             492
lead_time                                470
avg_price_per_room                       452
no_of_adults                             408
arrival_year                             373
no_of_weekend_nights                     367
no_of_children                           318
Booking_ID                                 0
booking_status                             0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>There are quite a number of missing values. Let’s take a look at the missingness matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize missingness matrix</span>
<span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">hotels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_19_0.png" src="../_images/hotels_19_0.png" />
</div>
</div>
<p>I will start by checking rows with multiple missing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rows with multiple missing values</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        17
22176     9
33264     8
11088     8
27720     8
16632     7
5544      7
7392      7
29568     7
15840     7
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>I will drop the first row because all its values are missing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop the first row</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>I am going to proceed checking missing values by columns and deciding how to deal with them in each case.</p>
<p>Let’s start with the column with the maximum number of missing values: ‘required_car_parking_space’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the unique values</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;required_car_parking_space&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0., nan,  1.])
</pre></div>
</div>
</div>
</div>
<p>In this case it makes sense to assign missing values to 0 (not required car parking space).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing values</span>
<span class="n">hotels</span><span class="p">[</span><span class="s2">&quot;required_car_parking_space&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s look at the next column with multiple missing values: ‘market_segment_type’ (how the booking was made).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the unique values</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;market_segment_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Online&#39;, &#39;Offline&#39;, nan, &#39;Aviation&#39;, &#39;Complementary&#39;, &#39;Corporate&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize missingness matrix</span>
<span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">hotels</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;market_segment_type&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_30_0.png" src="../_images/hotels_30_0.png" />
</div>
</div>
<p>We see that there is a structural component to missing values in ‘market_segment_type’: they also come with a considerable amount of missing values in ‘arrival_year’ and ‘arrival_month’. Because of that. I decide to remove all those rows, because that way I also get rid of missing values in ‘arrival_year’ and ‘arrival_month’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop rows with missing values in column</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;market_segment_type&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at missing values in ‘room_type_reserved’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the unique values</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;room_type_reserved&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Room_Type 1&#39;, &#39;Room_Type 4&#39;, nan, &#39;Room_Type 2&#39;, &#39;Room_Type 6&#39;,
       &#39;Room_Type 7&#39;, &#39;Room_Type 5&#39;, &#39;Room_Type 3&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize missingness matrix</span>
<span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">hotels</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;room_type_reserved&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_35_0.png" src="../_images/hotels_35_0.png" />
</div>
</div>
<p>Missing values in ‘room_type_reserved’ come along with missign values in ‘repeated_guest’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the unique values</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;repeated_guest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.,  1., nan])
</pre></div>
</div>
</div>
</div>
<p>I decide to drop them altogether.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop rows with missing values in column</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;room_type_reserved&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take a lok at the next most numerous missing values column, ‘arrival_date’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the unique values</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;arrival_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 6., 11., 15., 18., 30., 26., 20.,  5., 10., 28., 19.,  7.,  9.,
       27., nan,  1., 21., 29., 16., 13.,  2.,  3., 25., 14.,  4., 17.,
       22., 23., 31.,  8., 12., 24.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize missingness matrix</span>
<span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">hotels</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;arrival_date&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_42_0.png" src="../_images/hotels_42_0.png" />
</div>
</div>
<p>There are no significant missing values in other columns at the same row.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hotels</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;arrival_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Booking_ID</th>
      <th>no_of_adults</th>
      <th>no_of_children</th>
      <th>no_of_weekend_nights</th>
      <th>no_of_week_nights</th>
      <th>type_of_meal_plan</th>
      <th>required_car_parking_space</th>
      <th>room_type_reserved</th>
      <th>lead_time</th>
      <th>arrival_year</th>
      <th>arrival_month</th>
      <th>arrival_date</th>
      <th>market_segment_type</th>
      <th>repeated_guest</th>
      <th>no_of_previous_cancellations</th>
      <th>no_of_previous_bookings_not_canceled</th>
      <th>avg_price_per_room</th>
      <th>no_of_special_requests</th>
      <th>booking_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>37</th>
      <td>INN00038</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>289.0</td>
      <td>2017.0</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>Offline</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>67.00</td>
      <td>0.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>74</th>
      <td>INN00075</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 4</td>
      <td>34.0</td>
      <td>2017.0</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>Offline</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>75.00</td>
      <td>0.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>111</th>
      <td>INN00112</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>Not Selected</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>1.0</td>
      <td>2018.0</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>127.00</td>
      <td>1.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>148</th>
      <td>INN00149</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>56.0</td>
      <td>2018.0</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>Offline</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>120.00</td>
      <td>0.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>185</th>
      <td>INN00186</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 4</td>
      <td>56.0</td>
      <td>2018.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>140.40</td>
      <td>1.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>36112</th>
      <td>INN36113</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>83.0</td>
      <td>2018.0</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>118.80</td>
      <td>1.0</td>
      <td>Canceled</td>
    </tr>
    <tr>
      <th>36149</th>
      <td>INN36150</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 2</td>
      <td>166.0</td>
      <td>2018.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>73.60</td>
      <td>2.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>36186</th>
      <td>INN36187</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 4</td>
      <td>58.0</td>
      <td>2018.0</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>72.69</td>
      <td>1.0</td>
      <td>Not_Canceled</td>
    </tr>
    <tr>
      <th>36223</th>
      <td>INN36224</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 1</td>
      <td>193.0</td>
      <td>2018.0</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>93.09</td>
      <td>1.0</td>
      <td>Canceled</td>
    </tr>
    <tr>
      <th>36260</th>
      <td>INN36261</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>Meal Plan 1</td>
      <td>0.0</td>
      <td>Room_Type 4</td>
      <td>178.0</td>
      <td>2018.0</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>Online</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>137.25</td>
      <td>1.0</td>
      <td>Canceled</td>
    </tr>
  </tbody>
</table>
<p>875 rows × 19 columns</p>
</div></div></div>
</div>
<p>I cannot see any pattern for this rows in any other column, so I will directly drop those rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop rows with missing values in column</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;arrival_date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at the next column with more missing values: ‘no_of_week_nights’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the unique values</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_week_nights&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 3.,  1.,  4.,  5.,  0.,  2., nan, 10.,  6., 11.,  7., 15.,  9.,
       13.,  8., 14., 12., 17., 16.])
</pre></div>
</div>
</div>
</div>
<p>‘no_of_weekend_nights’ may be related.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the unique values</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_weekend_nights&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 2.,  1.,  0., nan,  4.,  3.,  6.,  5.])
</pre></div>
</div>
</div>
</div>
<p>This is the criteria I will follow to solve missing values in these two columns:</p>
<ul class="simple">
<li><p>If both are missing, I will drop that row.</p></li>
<li><p>If one of them is missing and the value of the other one is 0, then I will drop that row.</p></li>
<li><p>If one of them is missing and the value of the other one is not 0, then I will assign 0.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop rows with missing values in both column</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;no_of_week_nights&#39;</span><span class="p">,</span> <span class="s1">&#39;no_of_weekend_nights&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Drop if missing value and 0 in the other column</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">hotels</span><span class="p">[(</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_week_nights&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_weekend_nights&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">hotels</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">hotels</span><span class="p">[(</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_weekend_nights&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_week_nights&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Assign value 0 if missing value but the other column has a non-zero value</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_week_nights&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_weekend_nights&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">),</span>
           <span class="s1">&#39;no_of_week_nights&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">hotels</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_week_nights&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_weekend_nights&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()),</span>
           <span class="s1">&#39;no_of_weekend_nights&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at ‘no_of_special_requests’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the unique values</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_special_requests&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1.,  0.,  3.,  2., nan,  4.,  5.])
</pre></div>
</div>
</div>
</div>
<p>It makes sense to assign 0 to missing values in this column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing values in column</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_special_requests&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at ‘type_of_meal_plan’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the unique values</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;type_of_meal_plan&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Not Selected&#39;, &#39;Meal Plan 1&#39;, nan, &#39;Meal Plan 2&#39;, &#39;Meal Plan 3&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<p>I assign missing values to ‘Not Selected’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing values in column</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;type_of_meal_plan&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;Not Selected&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>I will drop the ‘lead_time’ missing value rows. (‘lead_time’ has many unique values, I will check later on its data range with a rapid visualization).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop rows with missing values in column</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;lead_time&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at the next one, ‘avg_price_per_room’.</p>
<p>I will drop the missing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop rows with missing values in column</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;avg_price_per_room&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s now take a look at the ‘no_of_adults’ and ‘no_of_children’ columns. I will use the following criteria:</p>
<ul class="simple">
<li><p>I will drop rows with missing values in ‘no_of_adults’.</p></li>
<li><p>I will assign 0 to missing ‘no_of_children’ if ‘no_of_adults’ is not 0.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop rows with missing values in column</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;no_of_adults&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Assign value 0 if missing value but the other column has a non-zero value</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_children&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_adults&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">),</span>
           <span class="s1">&#39;no_of_children&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Fill missing values in column</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;no_of_children&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at the last features with missing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the unique values</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_previous_cancellations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0., nan,  3.,  1.,  2., 11.,  4.,  5.,  6., 13.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the unique values</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;no_of_previous_bookings_not_canceled&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0., nan,  5.,  1.,  3.,  4., 12., 19.,  2., 15., 17.,  7., 20.,
       16., 50., 13.,  6., 14., 34., 18., 10., 23., 11.,  8., 49., 47.,
       53.,  9., 33., 24., 52., 22., 21., 48., 28., 39., 25., 31., 38.,
       51., 42., 37., 35., 56., 44., 27., 32., 55., 26., 45., 30., 57.,
       46., 54., 43., 58., 41., 29., 40., 36.])
</pre></div>
</div>
</div>
</div>
<p>I will direclty drop rows with missing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop rows with missing values in column</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;no_of_previous_cancellations&#39;</span><span class="p">,</span> <span class="s1">&#39;no_of_previous_bookings_not_canceled&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, let’s confirm that we have removed all missing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize missingness matrix</span>
<span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">hotels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_75_0.png" src="../_images/hotels_75_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check for missing values</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Booking_ID                              0
no_of_adults                            0
no_of_children                          0
no_of_weekend_nights                    0
no_of_week_nights                       0
type_of_meal_plan                       0
required_car_parking_space              0
room_type_reserved                      0
lead_time                               0
arrival_year                            0
arrival_month                           0
arrival_date                            0
market_segment_type                     0
repeated_guest                          0
no_of_previous_cancellations            0
no_of_previous_bookings_not_canceled    0
avg_price_per_room                      0
no_of_special_requests                  0
booking_status                          0
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-consistency">
<h3>Data consistency<a class="headerlink" href="#data-consistency" title="Permalink to this headline">#</a></h3>
<p>Let’s explore date consistency creating a new column with datetime format, it will try to convert year, month and day into a date.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create new column &#39;date&#39;, coerce errors to detect date inconsistencies</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;arrival_year&#39;</span><span class="p">],</span>
                                     <span class="n">month</span><span class="o">=</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;arrival_month&#39;</span><span class="p">],</span>
                                     <span class="n">day</span><span class="o">=</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;arrival_date&#39;</span><span class="p">]),</span>
                                <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

<span class="c1"># Sum date inconsistencies (coerced errors set to na)</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>31
</pre></div>
</div>
</div>
</div>
<p>Let’s find what these date inconsistencies are about.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hotels</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;arrival_year&#39;</span><span class="p">,</span> <span class="s1">&#39;arrival_month&#39;</span><span class="p">,</span> <span class="s1">&#39;arrival_date&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>arrival_year</th>
      <th>arrival_month</th>
      <th>arrival_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2626</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>3677</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>5600</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>7648</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>8000</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>9153</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>9245</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>9664</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>9934</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>10593</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>10652</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>10747</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>11881</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>13958</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>15363</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>17202</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>18380</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>18534</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>18680</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>19013</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>20419</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>21674</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>21688</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>26108</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>27928</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>30616</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>30632</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>30839</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>32041</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>34638</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>35481</th>
      <td>2018.0</td>
      <td>2.0</td>
      <td>29.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>2018 was not a leap year, so these entries with date ‘2018-02-29’ are incorrect. I will drop them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop rows of unexisting date 2018-02-29</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">hotels</span><span class="p">[(</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;arrival_year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2018</span><span class="p">)</span> \
                   <span class="o">&amp;</span> <span class="p">(</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;arrival_month&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> \
                   <span class="o">&amp;</span> <span class="p">(</span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;arrival_date&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">29</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-ranges">
<h3>Data ranges<a class="headerlink" href="#data-ranges" title="Permalink to this headline">#</a></h3>
<p>‘lead_time’ had many unique values, I will visualize a rapid histogram to check that they are within an expected range.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;lead_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;hist&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lead Time (days)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_86_0.png" src="../_images/hotels_86_0.png" />
</div>
</div>
<p>Let’s take a look at the average price per room.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;avg_price_per_room&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;hist&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Average Price per Room&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_88_0.png" src="../_images/hotels_88_0.png" />
</div>
</div>
<p>There are some rows with price around zero. I will leave it like that because I have no further information.</p>
</section>
<section id="data-types">
<h3>Data types<a class="headerlink" href="#data-types" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inspect the columns&#39; data types</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 23263 entries, 1 to 36274
Data columns (total 20 columns):
 #   Column                                Non-Null Count  Dtype         
---  ------                                --------------  -----         
 0   Booking_ID                            23263 non-null  object        
 1   no_of_adults                          23263 non-null  float64       
 2   no_of_children                        23263 non-null  float64       
 3   no_of_weekend_nights                  23263 non-null  float64       
 4   no_of_week_nights                     23263 non-null  float64       
 5   type_of_meal_plan                     23263 non-null  object        
 6   required_car_parking_space            23263 non-null  float64       
 7   room_type_reserved                    23263 non-null  object        
 8   lead_time                             23263 non-null  float64       
 9   arrival_year                          23263 non-null  float64       
 10  arrival_month                         23263 non-null  float64       
 11  arrival_date                          23263 non-null  float64       
 12  market_segment_type                   23263 non-null  object        
 13  repeated_guest                        23263 non-null  float64       
 14  no_of_previous_cancellations          23263 non-null  float64       
 15  no_of_previous_bookings_not_canceled  23263 non-null  float64       
 16  avg_price_per_room                    23263 non-null  float64       
 17  no_of_special_requests                23263 non-null  float64       
 18  booking_status                        23263 non-null  object        
 19  date                                  23263 non-null  datetime64[ns]
dtypes: datetime64[ns](1), float64(14), object(5)
memory usage: 3.7+ MB
</pre></div>
</div>
</div>
</div>
<p>Let’s convert to ‘category’ type the corresponding columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Turn to category</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;type_of_meal_plan&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;type_of_meal_plan&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

<span class="c1"># Turn to category</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;room_type_reserved&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;room_type_reserved&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

<span class="c1"># Turn to category</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;market_segment_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;market_segment_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

<span class="c1"># Turn to category</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;booking_status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;booking_status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inspect the columns&#39; data types</span>
<span class="n">hotels</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 23263 entries, 1 to 36274
Data columns (total 20 columns):
 #   Column                                Non-Null Count  Dtype         
---  ------                                --------------  -----         
 0   Booking_ID                            23263 non-null  object        
 1   no_of_adults                          23263 non-null  float64       
 2   no_of_children                        23263 non-null  float64       
 3   no_of_weekend_nights                  23263 non-null  float64       
 4   no_of_week_nights                     23263 non-null  float64       
 5   type_of_meal_plan                     23263 non-null  category      
 6   required_car_parking_space            23263 non-null  float64       
 7   room_type_reserved                    23263 non-null  category      
 8   lead_time                             23263 non-null  float64       
 9   arrival_year                          23263 non-null  float64       
 10  arrival_month                         23263 non-null  float64       
 11  arrival_date                          23263 non-null  float64       
 12  market_segment_type                   23263 non-null  category      
 13  repeated_guest                        23263 non-null  float64       
 14  no_of_previous_cancellations          23263 non-null  float64       
 15  no_of_previous_bookings_not_canceled  23263 non-null  float64       
 16  avg_price_per_room                    23263 non-null  float64       
 17  no_of_special_requests                23263 non-null  float64       
 18  booking_status                        23263 non-null  category      
 19  date                                  23263 non-null  datetime64[ns]
dtypes: category(4), datetime64[ns](1), float64(14), object(1)
memory usage: 3.1+ MB
</pre></div>
</div>
</div>
</div>
<p>The dataset size has changed after validation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hotels_init_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> rows and </span><span class="si">{</span><span class="n">hotels_init_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1"> columns initially&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hotels</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> rows and </span><span class="si">{</span><span class="n">hotels</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1"> after cleaning&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>36275 rows and 19 columns initially
23263 rows and 20 after cleaning
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="exploratory-data-analysis">
<h2>Exploratory Data Analysis<a class="headerlink" href="#exploratory-data-analysis" title="Permalink to this headline">#</a></h2>
<p>I will explore the data inspecting cancelations for each feature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define color palette</span>
<span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="s1">&#39;tomato&#39;</span><span class="p">]</span>

<span class="c1"># Define feature plotting function</span>
<span class="k">def</span> <span class="nf">plot_by</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">xticks_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">xticks_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">],</span>
            <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    
    <span class="c1"># Group by feature</span>
    <span class="n">hotels_featurely</span> <span class="o">=</span> <span class="n">hotels</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">feature</span><span class="p">)[</span><span class="s1">&#39;booking_status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
                    <span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;Not_Canceled&#39;</span><span class="p">,</span> <span class="s1">&#39;Canceled&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># Calculate cancelation index</span>
    <span class="n">hotels_featurely</span><span class="p">[</span><span class="s1">&#39;cancel_index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hotels_featurely</span><span class="p">[</span><span class="s1">&#39;Canceled&#39;</span><span class="p">]</span>\
                    <span class="o">/</span> <span class="p">(</span><span class="n">hotels_featurely</span><span class="p">[</span><span class="s1">&#39;Canceled&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">hotels_featurely</span><span class="p">[</span><span class="s1">&#39;Not_Canceled&#39;</span><span class="p">])</span>
    
    <span class="c1"># Define plot figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># Plot</span>
    <span class="n">hotels_featurely</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;cancel_index&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                                       <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                                                       <span class="n">color</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>
    <span class="c1"># Plot twin axis</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">hotels_featurely</span><span class="p">[</span><span class="s1">&#39;cancel_index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span>
                                          <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cancel index&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="c1"># Area</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Labels    </span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;# of bookings&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Cancelation index&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="c1"># Ticks</span>
    <span class="k">if</span> <span class="n">xticks_range</span> <span class="o">!=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks_range</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">xticks_labels</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="c1"># Limits</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Legend</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Booking status&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">))</span>
    <span class="c1"># Show</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">return</span>
</pre></div>
</div>
</div>
</div>
<section id="inspecting-proportion-of-target-variable">
<h3>Inspecting proportion of target variable<a class="headerlink" href="#inspecting-proportion-of-target-variable" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;booking_status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Booking status&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;# of bookings&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_100_0.png" src="../_images/hotels_100_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the proportion of the binary target variable</span>
<span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;booking_status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not_Canceled    0.707475
Canceled        0.292525
Name: booking_status, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>There is an imbalance in the binary target variable. The proportion difference is not very high, but it could affect negatively the predictive results because the class of interest is the one less represented (we want to predict cancelled bookings) and therefore there is less information available to it. I will address this issue while modeling.</p>
</section>
<section id="inspecting-by-dates">
<h3>Inspecting by dates<a class="headerlink" href="#inspecting-by-dates" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">,</span>
        <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_104_0.png" src="../_images/hotels_104_0.png" />
</div>
</div>
</section>
<section id="inspecting-by-month">
<h3>Inspecting by month<a class="headerlink" href="#inspecting-by-month" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">by_date</span> <span class="o">=</span> <span class="n">hotels</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)[</span><span class="s1">&#39;booking_status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
            <span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;Not_Canceled&#39;</span><span class="p">,</span> <span class="s1">&#39;Canceled&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">by_month</span> <span class="o">=</span> <span class="n">by_date</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by_date</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="p">)[[</span><span class="s1">&#39;Not_Canceled&#39;</span><span class="p">,</span> <span class="s1">&#39;Canceled&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">by_month</span><span class="p">[</span><span class="s1">&#39;cancel_index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">by_month</span><span class="p">[</span><span class="s1">&#39;Canceled&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">by_month</span><span class="p">[</span><span class="s1">&#39;Canceled&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">by_month</span><span class="p">[</span><span class="s1">&#39;Not_Canceled&#39;</span><span class="p">])</span>

<span class="c1"># Define plot figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="c1"># Plot</span>
<span class="n">by_month</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;cancel_index&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                                   <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                                                   <span class="n">color</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>
<span class="c1"># Plot twin axis</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">by_month</span><span class="p">[</span><span class="s1">&#39;cancel_index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span>
                                      <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                                      <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cancel index&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1"># Area</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Labels    </span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;# of bookings&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Cancelation index&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1"># Ticks</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_abbr</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="c1"># Limits</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># Legend</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Booking status&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">))</span>
<span class="c1"># Show</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_106_0.png" src="../_images/hotels_106_0.png" />
</div>
</div>
</section>
<section id="inspecting-by-week-day">
<h3>Inspecting by week day<a class="headerlink" href="#inspecting-by-week-day" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;day_of_week&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_of_week</span>
<span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;day_of_week&#39;</span><span class="p">,</span>
        <span class="n">xticks_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">xticks_labels</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">calendar</span><span class="o">.</span><span class="n">day_abbr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_108_0.png" src="../_images/hotels_108_0.png" />
</div>
</div>
</section>
<section id="inspecting-by-lead-time">
<h3>Inspecting by lead time<a class="headerlink" href="#inspecting-by-lead-time" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;lead_time&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lead time (days)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_110_0.png" src="../_images/hotels_110_0.png" />
</div>
</div>
</section>
<section id="inspecting-by-repeated-guest-and-previous-cancelations">
<h3>Inspecting by repeated guest and previous cancelations<a class="headerlink" href="#inspecting-by-repeated-guest-and-previous-cancelations" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;repeated_guest&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Repeated guest&#39;</span><span class="p">,</span>
        <span class="n">xticks_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">xticks_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_112_0.png" src="../_images/hotels_112_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;no_of_previous_cancellations&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Number of previous cancelations&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_113_0.png" src="../_images/hotels_113_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;no_of_previous_bookings_not_canceled&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Number of previous bookings not canceled&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_114_0.png" src="../_images/hotels_114_0.png" />
</div>
</div>
</section>
<section id="inspecting-by-number-of-adults-and-children">
<h3>Inspecting by number of adults and children<a class="headerlink" href="#inspecting-by-number-of-adults-and-children" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;no_of_adults&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Number of adults&#39;</span><span class="p">,</span>
       <span class="n">xticks_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">xticks_labels</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_116_0.png" src="../_images/hotels_116_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;no_of_children&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Number of children&#39;</span><span class="p">,</span>
       <span class="n">xticks_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">xticks_labels</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_117_0.png" src="../_images/hotels_117_0.png" />
</div>
</div>
</section>
<section id="inspecting-by-number-of-week-and-weekdend-nights">
<h3>Inspecting by number of week and weekdend nights<a class="headerlink" href="#inspecting-by-number-of-week-and-weekdend-nights" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;no_of_week_nights&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Number of week nights&#39;</span><span class="p">,</span>
       <span class="n">xticks_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">18</span><span class="p">),</span> <span class="n">xticks_labels</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">18</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_119_0.png" src="../_images/hotels_119_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;no_of_weekend_nights&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Number of weekend nights&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_120_0.png" src="../_images/hotels_120_0.png" />
</div>
</div>
</section>
<section id="inspecting-by-required-car-parking-space">
<h3>Inspecting by required car parking space<a class="headerlink" href="#inspecting-by-required-car-parking-space" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;required_car_parking_space&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Required car parking space&#39;</span><span class="p">,</span>
        <span class="n">xticks_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">xticks_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_122_0.png" src="../_images/hotels_122_0.png" />
</div>
</div>
</section>
<section id="inspecting-by-number-of-special-requests">
<h3>Inspecting by number of special requests<a class="headerlink" href="#inspecting-by-number-of-special-requests" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;no_of_special_requests&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Number of special requests&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_124_0.png" src="../_images/hotels_124_0.png" />
</div>
</div>
</section>
<section id="inspect-by-average-price-per-room">
<h3>Inspect by average price per room<a class="headerlink" href="#inspect-by-average-price-per-room" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Group by feature</span>
<span class="n">by_price</span> <span class="o">=</span> <span class="n">hotels</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;avg_price_per_room&#39;</span><span class="p">)[</span><span class="s1">&#39;booking_status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>\
                <span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s1">&#39;Not_Canceled&#39;</span><span class="p">,</span> <span class="s1">&#39;Canceled&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Establish price intervals</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IntervalIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">550</span><span class="p">,</span> <span class="mi">50</span><span class="p">)],</span> <span class="n">closed</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Create new column with intervals</span>
<span class="n">by_price</span><span class="p">[</span><span class="s2">&quot;interval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">by_price</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>

<span class="n">by_price_interval</span> <span class="o">=</span> <span class="n">by_price</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;interval&#39;</span><span class="p">)[[</span><span class="s1">&#39;Not_Canceled&#39;</span><span class="p">,</span> <span class="s1">&#39;Canceled&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">by_price_interval</span><span class="p">[</span><span class="s1">&#39;cancel_index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">by_price_interval</span><span class="p">[</span><span class="s1">&#39;Canceled&#39;</span><span class="p">]</span>\
            <span class="o">/</span> <span class="p">(</span><span class="n">by_price_interval</span><span class="p">[</span><span class="s1">&#39;Canceled&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">by_price_interval</span><span class="p">[</span><span class="s1">&#39;Not_Canceled&#39;</span><span class="p">])</span>
<span class="n">by_price_interval</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Define plot figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="c1"># Plot</span>
<span class="n">by_price_interval</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;cancel_index&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                                   <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                                                   <span class="n">color</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>
<span class="c1"># Plot twin axis</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">by_price_interval</span><span class="p">[</span><span class="s1">&#39;cancel_index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span>
                                      <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                                      <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cancel index&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1"># Area</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Labels    </span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Price per room&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;# of bookings&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Cancelation index&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1"># Ticks</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;[&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">50</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">550</span><span class="p">,</span> <span class="mi">50</span><span class="p">)])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="c1"># Limits</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># Legend</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Booking status&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">))</span>
<span class="c1"># Show</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_126_0.png" src="../_images/hotels_126_0.png" />
</div>
</div>
</section>
<section id="inspect-by-market-segment-type">
<h3>Inspect by market segment type<a class="headerlink" href="#inspect-by-market-segment-type" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;market_segment_type&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_128_0.png" src="../_images/hotels_128_0.png" />
</div>
</div>
</section>
<section id="inspect-by-room-type">
<h3>Inspect by room type<a class="headerlink" href="#inspect-by-room-type" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;room_type_reserved&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Room type reserved&#39;</span><span class="p">,</span>
       <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_130_0.png" src="../_images/hotels_130_0.png" />
</div>
</div>
</section>
<section id="inspect-by-meal-type">
<h3>Inspect by meal type<a class="headerlink" href="#inspect-by-meal-type" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_by</span><span class="p">(</span><span class="s1">&#39;type_of_meal_plan&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Type of meal plan&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_132_0.png" src="../_images/hotels_132_0.png" />
</div>
</div>
</section>
</section>
<section id="modelling">
<h2>Modelling<a class="headerlink" href="#modelling" title="Permalink to this headline">#</a></h2>
<section id="data-preprocessing">
<h3>Data preprocessing<a class="headerlink" href="#data-preprocessing" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define features</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">hotels</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Booking_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;booking_status&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Define target</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">hotels</span><span class="p">[</span><span class="s1">&#39;booking_status&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Not_Canceled&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Canceled&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Redundant features</span>
<span class="c1"># features.corr()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prepare features</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

<span class="c1"># Prepare target</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">target</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;no_of_adults&#39;, &#39;no_of_children&#39;, &#39;no_of_weekend_nights&#39;,
       &#39;no_of_week_nights&#39;, &#39;required_car_parking_space&#39;, &#39;lead_time&#39;,
       &#39;arrival_year&#39;, &#39;arrival_month&#39;, &#39;arrival_date&#39;, &#39;repeated_guest&#39;,
       &#39;no_of_previous_cancellations&#39;, &#39;no_of_previous_bookings_not_canceled&#39;,
       &#39;avg_price_per_room&#39;, &#39;no_of_special_requests&#39;, &#39;day_of_week&#39;,
       &#39;type_of_meal_plan_Meal Plan 1&#39;, &#39;type_of_meal_plan_Meal Plan 2&#39;,
       &#39;type_of_meal_plan_Meal Plan 3&#39;, &#39;type_of_meal_plan_Not Selected&#39;,
       &#39;room_type_reserved_Room_Type 1&#39;, &#39;room_type_reserved_Room_Type 2&#39;,
       &#39;room_type_reserved_Room_Type 3&#39;, &#39;room_type_reserved_Room_Type 4&#39;,
       &#39;room_type_reserved_Room_Type 5&#39;, &#39;room_type_reserved_Room_Type 6&#39;,
       &#39;room_type_reserved_Room_Type 7&#39;, &#39;market_segment_type_Aviation&#39;,
       &#39;market_segment_type_Complementary&#39;, &#39;market_segment_type_Corporate&#39;,
       &#39;market_segment_type_Offline&#39;, &#39;market_segment_type_Online&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split dataset into 70% training and 30% test set, and stratify</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                                                    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                                                    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
                                                    <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Scale X</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="logistic-regression">
<h3>Logistic Regression<a class="headerlink" href="#logistic-regression" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Logistic Regression</span>
<span class="n">logreg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">logreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred_log</span> <span class="o">=</span> <span class="n">logreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the performance metrics</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Confusion matrix: </span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_log</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Report: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_log</span><span class="p">,</span>
                                           <span class="n">target_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Not cancelled -&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;Cancelled -&gt;&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confusion matrix: 

 [[4444  493]
 [ 858 1184]]

Report: 
                   precision    recall  f1-score   support

Not cancelled -&gt;       0.84      0.90      0.87      4937
    Cancelled -&gt;       0.71      0.58      0.64      2042

        accuracy                           0.81      6979
       macro avg       0.77      0.74      0.75      6979
    weighted avg       0.80      0.81      0.80      6979
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">importance</span> <span class="o">=</span> <span class="n">logreg</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">importance</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1.58342872e-02,  4.83248476e-02,  6.24367484e-02,  1.09133394e-01,
       -2.95263602e-01,  1.10578213e+00,  1.14263346e-01, -1.22127844e-01,
       -4.20784876e-02, -4.86870274e-01,  8.90334597e-02, -2.34855936e-01,
        6.19313201e-01, -1.17747707e+00, -4.74923167e-02, -3.18537392e-02,
       -1.57226498e-02,  9.27320577e-02,  3.97630351e-02,  7.56384076e-02,
       -4.94277046e-02,  1.57537348e-02,  5.80502170e-04, -3.58131266e-02,
       -9.53703099e-02, -8.12072113e-02,  7.67230105e-02, -5.98156219e-01,
        7.46100045e-02, -4.02201525e-01,  4.63889017e-01])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">importance</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/hotels_144_0.png" src="../_images/hotels_144_0.png" />
</div>
</div>
</section>
<section id="knn">
<h3>kNN<a class="headerlink" href="#knn" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># K-Nearest Neighbor</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred_knn</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the performance metrics</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Confusion matrix: </span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Report: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">,</span>
                                           <span class="n">target_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Not cancelled -&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;Cancelled -&gt;&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confusion matrix: 

 [[4519  418]
 [ 979 1063]]

Report: 
                   precision    recall  f1-score   support

Not cancelled -&gt;       0.82      0.92      0.87      4937
    Cancelled -&gt;       0.72      0.52      0.60      2042

        accuracy                           0.80      6979
       macro avg       0.77      0.72      0.73      6979
    weighted avg       0.79      0.80      0.79      6979
</pre></div>
</div>
</div>
</div>
</section>
<section id="decision-trees">
<h3>Decision Trees<a class="headerlink" href="#decision-trees" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># DecisionTreeClassifier</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">dt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span> <span class="c1"># No need for X scaling</span>
<span class="n">y_pred_dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the performance metrics</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Confusion matrix: </span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_dt</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Report: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_dt</span><span class="p">,</span>
                                           <span class="n">target_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Not cancelled -&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;Cancelled -&gt;&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confusion matrix: 

 [[4456  481]
 [ 668 1374]]

Report: 
                   precision    recall  f1-score   support

Not cancelled -&gt;       0.87      0.90      0.89      4937
    Cancelled -&gt;       0.74      0.67      0.71      2042

        accuracy                           0.84      6979
       macro avg       0.81      0.79      0.80      6979
    weighted avg       0.83      0.84      0.83      6979
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Mikel Imaz, 2023<br/>
  
    <div class="extra_footer">
      <p>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
</p>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>